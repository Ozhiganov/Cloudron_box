"use strict";var app=angular.module("Application",["ngRoute","ngAnimate","angular-md5"]);app.directive("ngEnter",function(){return function(t,e,n){e.bind("keydown keypress",function(e){13===e.which&&(t.$apply(function(){t.$eval(n.ngEnter)}),e.preventDefault())})}}),app.config(["$routeProvider",function(t){t.when("/",{redirectTo:"/step1"}).when("/step1",{controller:"StepController",templateUrl:"views/setup/step1.html"}).when("/step2",{controller:"StepController",templateUrl:"views/setup/step2.html"}).when("/step3",{controller:"StepController",templateUrl:"views/setup/step3.html"}).when("/step4",{controller:"StepController",templateUrl:"views/setup/step4.html"}).when("/step5",{controller:"FinishController",templateUrl:"views/setup/step5.html"}).otherwise({redirectTo:"/"})}]),app.service("Wizard",[function(){function t(){this.username="",this.email="",this.password=""}var e=null;return e=new t}]),app.controller("StepController",["$scope","$location","Wizard",function(t,e,n){t.wizard=n,t.ok=function(t,n){n||e.path(t)},t.$on("$viewContentLoaded",function(){$("input[autofocus]").focus()})}]),app.controller("FinishController",["$scope","$location","$timeout","Wizard","Client",function(t,e,n,o,r){function i(){r.createAdmin(t.wizard.username,t.wizard.password,t.wizard.email,t.setupToken,function(t){return t?(console.error("Internal error",t),void(window.location.href="/error.html")):void(window.location.href="/")})}t.wizard=o,n(i,1e3)}]),app.controller("SetupController",["$scope","$location","Client","Wizard",function(t,e,n,o){t.initialized=!1;var r=window.location.search.slice(1).split("&").map(function(t){return t.split("=")}).reduce(function(t,e){return t[e[0]]=e[1],t},{});t.setupToken=r.setupToken,n.isServerFirstTime(function(n,r){return n?void(window.location.href="/error.html"):r?(o.username||e.path("/step1"),void(t.initialized=!0)):void(window.location.href="/")})}]),angular.module("Application").service("Client",["$http","md5",function(t,e){function n(t,e){Error.call(this),this.name=this.constructor.name,this.statusCode=t,this.message="string"==typeof e?e:JSON.stringify(e)}function o(t){return function(e,o){return 401===o?i.logout():void t(new n(o,e))}}function r(){this._ready=!1,this._configListener=[],this._readyListener=[],this._userInfo={username:null,email:null,admin:!1},this._token=null,this._clientId="cid-webadmin",this._clientSecret="unused",this._config={apiServerOrigin:null,webServerOrigin:null,fqdn:null,ip:null,revision:null,update:{box:null,apps:null},isDev:!1,progress:{}},this._installedApps=[],this.setToken(localStorage.token)}var i=null;return r.prototype.setReady=function(){this._ready||(this._ready=!0,this._readyListener.forEach(function(t){t()}))},r.prototype.onReady=function(t){this._ready&&t(),this._readyListener.push(t)},r.prototype.onConfig=function(t){this._configListener.push(t),t(this._config)},r.prototype.setUserInfo=function(t){this._userInfo.username=t.username,this._userInfo.email=t.email,this._userInfo.admin=!!t.admin,this._userInfo.gravatar="https://www.gravatar.com/avatar/"+e.createHash(t.email.toLowerCase())+".jpg?s=24&d=mm",this._userInfo.gravatarHuge="https://www.gravatar.com/avatar/"+e.createHash(t.email.toLowerCase())+".jpg?s=128&d=mm"},r.prototype.setConfig=function(t){this._config.apiServerOrigin=t.apiServerOrigin,this._config.webServerOrigin=t.webServerOrigin,this._config.version=t.version,this._config.fqdn=t.fqdn,this._config.ip=t.ip,this._config.revision=t.revision,this._config.update=t.update,this._config.isDev=t.isDev,this._config.progress=t.progress;var e=this;this._configListener.forEach(function(t){t(e._config)})},r.prototype.getInstalledApps=function(){return this._installedApps},r.prototype.getUserInfo=function(){return this._userInfo},r.prototype.getConfig=function(){return this._config},r.prototype.setToken=function(e){t.defaults.headers.common.Authorization="Bearer "+e,e?localStorage.token=e:localStorage.removeItem("token"),this._token=e},r.prototype.config=function(e){t.get("/api/v1/cloudron/config").success(function(t,o){return 200!==o||"object"!=typeof t?e(new n(o,t)):void e(null,t)}).error(o(e))},r.prototype.userInfo=function(e){t.get("/api/v1/profile").success(function(t,o){return 200!==o||"object"!=typeof t?e(new n(o,t)):void e(null,t)}).error(o(e))},r.prototype.installApp=function(e,r,i,s,p,u){var a=this,c={appStoreId:e,manifest:r,password:i,location:p.location,portBindings:p.portBindings,accessRestriction:p.accessRestriction};t.post("/api/v1/apps/install",c).success(function(t,e){return 202!==e||"object"!=typeof t?u(new n(e,t)):(t.manifest={title:s},a._installedApps.push(t),void u(null,t.id))}).error(o(u))},r.prototype.uninstallApp=function(e,r,i){var s={password:r};t.post("/api/v1/apps/"+e+"/uninstall",s).success(function(t,e){return 202!==e?i(new n(e,t)):void i(null)}).error(o(i))},r.prototype.configureApp=function(e,r,i,s){var p={appId:e,password:r,location:i.location,portBindings:i.portBindings,accessRestriction:i.accessRestriction};t.post("/api/v1/apps/"+e+"/configure",p).success(function(t,e){return 202!==e?s(new n(e,t)):void s(null)}).error(o(s))},r.prototype.updateApp=function(e,r,i,s){t.post("/api/v1/apps/"+e+"/update",{manifest:r,password:i}).success(function(t,e){return 202!==e?s(new n(e,t)):void s(null)}).error(o(s))},r.prototype.startApp=function(e,r){var i={};t.post("/api/v1/apps/"+e+"/start",i).success(function(t,e){return 202!==e?r(new n(e,t)):void r(null)}).error(o(r))},r.prototype.stopApp=function(e,r){var i={};t.post("/api/v1/apps/"+e+"/stop",i).success(function(t,e){return 202!==e?r(new n(e,t)):void r(null)}).error(o(r))},r.prototype.version=function(e){t.get("/api/v1/cloudron/status").success(function(t,o){return 200!==o||"object"!=typeof t?e(new n(o,t)):void e(null,t)}).error(o(e))},r.prototype.isServerFirstTime=function(e){t.get("/api/v1/cloudron/status").success(function(t,o){return 200!==o||"object"!=typeof t?e(new n(o,t)):void e(null,!t.activated)}).error(o(e))},r.prototype.getNakedDomain=function(e){t.get("/api/v1/settings/naked_domain").success(function(t,o){return 200!==o||"object"!=typeof t?e(new n(o,t)):void e(null,t.appid)}).error(o(e))},r.prototype.setNakedDomain=function(e,r){t.post("/api/v1/settings/naked_domain",{appid:e}).success(function(t,e){return 204!==e?r(new n(e)):void r(null)}).error(o(r))},r.prototype.getApps=function(e){t.get("/api/v1/apps").success(function(t,o){return 200!==o||"object"!=typeof t?e(new n(o,t)):void e(null,t.apps)}).error(o(e))},r.prototype.getApp=function(t,e){var n=null;return this._installedApps.some(function(e){return e.id===t?(n=e,!0):!1}),n?e(null,n):e(new Error("App not found"))},r.prototype.getAppLogStream=function(t){var e=new EventSource("/api/v1/apps/"+t+"/logstream");return e},r.prototype.getAppLogUrl=function(t){return"/api/v1/apps/"+t+"/logs?access_token="+this._token},r.prototype.setAdmin=function(e,r,i){var s={username:e,admin:r};t.post("/api/v1/users/"+e+"/admin",s).success(function(t,e){return 204!==e?i(new n(e,t)):void i(null)}).error(o(i))},r.prototype.createAdmin=function(e,r,i,s,p){var u={username:e,password:r,email:i},a=this;t.post("/api/v1/cloudron/activate?setupToken="+s,u).success(function(t,o){return 201!==o||"object"!=typeof t?p(new n(o,t)):(a.setToken(t.token),a.setUserInfo({username:e,email:i,admin:!0}),void p(null,t.activated))}).error(o(p))},r.prototype.listUsers=function(e){t.get("/api/v1/users").success(function(t,o){return 200!==o||"object"!=typeof t?e(new n(o,t)):void e(null,t)}).error(o(e))},r.prototype.getOAuthClients=function(e){t.get("/api/v1/oauth/clients").success(function(t,o){return 200!==o||"object"!=typeof t?e(new n(o,t)):void e(null,t.clients)}).error(o(e))},r.prototype.delTokensByClientId=function(e,r){t["delete"]("/api/v1/oauth/clients/"+e+"/tokens").success(function(t,e){return 204!==e?r(new n(e,t)):void r(null)}).error(o(r))},r.prototype.update=function(e,r){t.post("/api/v1/cloudron/update",{password:e}).success(function(t,e){return 202!==e||"object"!=typeof t?r(new n(e,t)):void r(null,t)}).error(o(r))},r.prototype.reboot=function(e){t.get("/api/v1/cloudron/reboot").success(function(t,o){return 202!==o||"object"!=typeof t?e(new n(o,t)):void e(null,t)}).error(o(e))},r.prototype.backup=function(e){t.post("/api/v1/cloudron/backups").success(function(t,o){return 202!==o||"object"!=typeof t?e(new n(o,t)):void e(null,t)}).error(o(e))},r.prototype.setCertificate=function(e,r,i){console.log("will set certificate");var s=new FormData;s.append("certificate",e),s.append("key",r),t.post("/api/v1/cloudron/certificate",s,{headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(t,e){return 202!==e?i(new n(e,t)):void i(null)}).error(o(i))},r.prototype.graphs=function(e,r,i){var s={params:{target:e,format:"json",from:r}};t.get("/api/v1/cloudron/graphs",s).success(function(t,e){return 200!==e||"object"!=typeof t?i(new n(e,t)):void i(null,t)}).error(o(i))},r.prototype.createUser=function(e,r,i){var s={username:e,email:r};t.post("/api/v1/users",s).success(function(t,e){return 201!==e||"object"!=typeof t?i(new n(e,t)):void i(null,t)}).error(o(i))},r.prototype.removeUser=function(e,r,i){var s={username:e,password:r};t({method:"DELETE",url:"/api/v1/users/"+e,data:s,headers:{"Content-Type":"application/json"}}).success(function(t,e){return 204!==e?i(new n(e,t)):void i(null)}).error(o(i))},r.prototype.changePassword=function(e,r,i){var s={password:e,newPassword:r};t.post("/api/v1/users/"+this._userInfo.username+"/password",s).success(function(t,e){return 204!==e?i(new n(e,t)):void i(null,t)}).error(o(i))},r.prototype.refreshConfig=function(t){var e=this;t="function"==typeof t?t:function(){},this.config(function(n,o){return n?t(n):(e.setConfig(o),void t(null))})},r.prototype.refreshInstalledApps=function(t){var e=this;t="function"==typeof t?t:function(){},this.getApps(function(n,o){if(n)return t(n);o.forEach(function(t){for(var n=!1,o=0;o<e._installedApps.length;++o)if(e._installedApps[o].id===t.id){n=o;break}n!==!1?angular.copy(t,e._installedApps[n]):e._installedApps.push(t)});for(var r=e._installedApps.length-1;r>=0;--r)o.some(function(t){return t.id===e._installedApps[r].id})||e._installedApps.splice(r,1);t(null)})},r.prototype.logout=function(){this.setToken(null),this._userInfo={},window.location.href="/api/v1/session/logout"},r.prototype.exchangeCodeForToken=function(e,r){var i={grant_type:"authorization_code",code:e,redirect_uri:window.location.origin,client_id:this._clientId,client_secret:this._clientSecret};t.post("/api/v1/oauth/token?response_type=token&client_id="+this._clientId,i).success(function(t,e){return 200!==e||"object"!=typeof t?r(new n(e,t)):void r(null,t.access_token)}).error(o(r))},i=new r}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNldHVwLmpzIiwiY2xpZW50LmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJkaXJlY3RpdmUiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRycyIsImJpbmQiLCJldmVudCIsIndoaWNoIiwiJGFwcGx5IiwiJGV2YWwiLCJuZ0VudGVyIiwicHJldmVudERlZmF1bHQiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJyZWRpcmVjdFRvIiwiY29udHJvbGxlciIsInRlbXBsYXRlVXJsIiwib3RoZXJ3aXNlIiwic2VydmljZSIsIldpemFyZCIsInRoaXMiLCJ1c2VybmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJpbnN0YW5jZSIsIiRzY29wZSIsIiRsb2NhdGlvbiIsIndpemFyZCIsIm9rIiwicGFnZSIsImJhZCIsInBhdGgiLCIkb24iLCIkIiwiZm9jdXMiLCIkdGltZW91dCIsIkNsaWVudCIsImZpbmlzaCIsImNyZWF0ZUFkbWluIiwic2V0dXBUb2tlbiIsImVycm9yIiwiY29uc29sZSIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsImluaXRpYWxpemVkIiwic2VhcmNoIiwic2xpY2UiLCJzcGxpdCIsIm1hcCIsIml0ZW0iLCJyZWR1Y2UiLCJvIiwiayIsImlzU2VydmVyRmlyc3RUaW1lIiwiaXNGaXJzdFRpbWUiLCIkaHR0cCIsIm1kNSIsIkNsaWVudEVycm9yIiwic3RhdHVzQ29kZSIsIm1lc3NhZ2UiLCJFcnJvciIsImNhbGwiLCJuYW1lIiwiY29uc3RydWN0b3IiLCJKU09OIiwic3RyaW5naWZ5IiwiZGVmYXVsdEVycm9ySGFuZGxlciIsImNhbGxiYWNrIiwiZGF0YSIsInN0YXR1cyIsImNsaWVudCIsImxvZ291dCIsIl9yZWFkeSIsIl9jb25maWdMaXN0ZW5lciIsIl9yZWFkeUxpc3RlbmVyIiwiX3VzZXJJbmZvIiwiYWRtaW4iLCJfdG9rZW4iLCJfY2xpZW50SWQiLCJfY2xpZW50U2VjcmV0IiwiX2NvbmZpZyIsImFwaVNlcnZlck9yaWdpbiIsIndlYlNlcnZlck9yaWdpbiIsImZxZG4iLCJpcCIsInJldmlzaW9uIiwidXBkYXRlIiwiYm94IiwiYXBwcyIsImlzRGV2IiwicHJvZ3Jlc3MiLCJfaW5zdGFsbGVkQXBwcyIsInNldFRva2VuIiwibG9jYWxTdG9yYWdlIiwidG9rZW4iLCJwcm90b3R5cGUiLCJzZXRSZWFkeSIsImZvckVhY2giLCJvblJlYWR5IiwicHVzaCIsIm9uQ29uZmlnIiwic2V0VXNlckluZm8iLCJ1c2VySW5mbyIsImdyYXZhdGFyIiwiY3JlYXRlSGFzaCIsInRvTG93ZXJDYXNlIiwiZ3JhdmF0YXJIdWdlIiwic2V0Q29uZmlnIiwidmVyc2lvbiIsInRoYXQiLCJnZXRJbnN0YWxsZWRBcHBzIiwiZ2V0VXNlckluZm8iLCJnZXRDb25maWciLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJBdXRob3JpemF0aW9uIiwicmVtb3ZlSXRlbSIsImdldCIsInN1Y2Nlc3MiLCJpbnN0YWxsQXBwIiwiaWQiLCJtYW5pZmVzdCIsInRpdGxlIiwiYXBwU3RvcmVJZCIsInBvcnRCaW5kaW5ncyIsImFjY2Vzc1Jlc3RyaWN0aW9uIiwicG9zdCIsInVuaW5zdGFsbEFwcCIsImFwcElkIiwiY29uZmlndXJlQXBwIiwidXBkYXRlQXBwIiwic3RhcnRBcHAiLCJzdG9wQXBwIiwiYWN0aXZhdGVkIiwiZ2V0TmFrZWREb21haW4iLCJhcHBpZCIsInNldE5ha2VkRG9tYWluIiwiZ2V0QXBwcyIsImdldEFwcCIsImFwcEZvdW5kIiwic29tZSIsImdldEFwcExvZ1N0cmVhbSIsInNvdXJjZSIsIkV2ZW50U291cmNlIiwiZ2V0QXBwTG9nVXJsIiwic2V0QWRtaW4iLCJwYXlsb2FkIiwibGlzdFVzZXJzIiwiZ2V0T0F1dGhDbGllbnRzIiwiY2xpZW50cyIsImRlbFRva2Vuc0J5Q2xpZW50SWQiLCJyZWJvb3QiLCJiYWNrdXAiLCJzZXRDZXJ0aWZpY2F0ZSIsImNlcnRpZmljYXRlRmlsZSIsImtleUZpbGUiLCJsb2ciLCJmZCIsIkZvcm1EYXRhIiwiYXBwZW5kIiwiQ29udGVudC1UeXBlIiwidW5kZWZpbmVkIiwidHJhbnNmb3JtUmVxdWVzdCIsImlkZW50aXR5IiwiZ3JhcGhzIiwidGFyZ2V0cyIsImZyb20iLCJwYXJhbXMiLCJ0YXJnZXQiLCJmb3JtYXQiLCJjcmVhdGVVc2VyIiwicmVtb3ZlVXNlciIsIm1ldGhvZCIsInVybCIsImNoYW5nZVBhc3N3b3JkIiwiY3VycmVudFBhc3N3b3JkIiwibmV3UGFzc3dvcmQiLCJyZWZyZXNoQ29uZmlnIiwicmVzdWx0IiwicmVmcmVzaEluc3RhbGxlZEFwcHMiLCJmb3VuZCIsImkiLCJsZW5ndGgiLCJjb3B5IiwiZWxlbSIsInNwbGljZSIsImV4Y2hhbmdlQ29kZUZvclRva2VuIiwiYXV0aENvZGUiLCJncmFudF90eXBlIiwiY29kZSIsInJlZGlyZWN0X3VyaSIsIm9yaWdpbiIsImNsaWVudF9pZCIsImNsaWVudF9zZWNyZXQiLCJhY2Nlc3NfdG9rZW4iXSwibWFwcGluZ3MiOiJBQUFBLFlBR0EsSUFBQUEsS0FBQUMsUUFBQUMsT0FBQSxlQUFBLFVBQUEsWUFBQSxlQUVBRixLQUFBRyxVQUFBLFVBQUEsV0FDQSxNQUFBLFVBQUFDLEVBQUFDLEVBQUFDLEdBQ0FELEVBQUFFLEtBQUEsbUJBQUEsU0FBQUMsR0FDQSxLQUFBQSxFQUFBQyxRQUNBTCxFQUFBTSxPQUFBLFdBQ0FOLEVBQUFPLE1BQUFMLEVBQUFNLFdBR0FKLEVBQUFLLHVCQU9BYixJQUFBYyxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLEtBQUEsS0FDQUMsV0FBQSxXQUNBRCxLQUFBLFVBQ0FFLFdBQUEsaUJBQ0FDLFlBQUEsMkJBQ0FILEtBQUEsVUFDQUUsV0FBQSxpQkFDQUMsWUFBQSwyQkFDQUgsS0FBQSxVQUNBRSxXQUFBLGlCQUNBQyxZQUFBLDJCQUNBSCxLQUFBLFVBQ0FFLFdBQUEsaUJBQ0FDLFlBQUEsMkJBQ0FILEtBQUEsVUFDQUUsV0FBQSxtQkFDQUMsWUFBQSwyQkFDQUMsV0FBQUgsV0FBQSxT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K0gsZ0JBQ0E1SixNQUFBMkIsRUFBQUMsS0FHQUcsRUFBQSxHQUFBbkMiLCJmaWxlIjoic2V0dXAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbi8vIGNyZWF0ZSBtYWluIGFwcGxpY2F0aW9uIG1vZHVsZVxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicsIFsnbmdSb3V0ZScsICduZ0FuaW1hdGUnLCAnYW5ndWxhci1tZDUnXSk7XG5cbmFwcC5kaXJlY3RpdmUoJ25nRW50ZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgZWxlbWVudC5iaW5kKCdrZXlkb3duIGtleXByZXNzJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICBpZihldmVudC53aGljaCA9PT0gMTMpIHtcbiAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCl7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRldmFsKGF0dHJzLm5nRW50ZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbn0pO1xuXG4vLyBzZXR1cCBhbGwgbWFqb3IgYXBwbGljYXRpb24gcm91dGVzXG5hcHAuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCBmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJywge1xuICAgICAgICByZWRpcmVjdFRvOiAnL3N0ZXAxJ1xuICAgIH0pLndoZW4oJy9zdGVwMScsIHtcbiAgICAgICAgY29udHJvbGxlcjogJ1N0ZXBDb250cm9sbGVyJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9zZXR1cC9zdGVwMS5odG1sJ1xuICAgIH0pLndoZW4oJy9zdGVwMicsIHtcbiAgICAgICAgY29udHJvbGxlcjogJ1N0ZXBDb250cm9sbGVyJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9zZXR1cC9zdGVwMi5odG1sJ1xuICAgIH0pLndoZW4oJy9zdGVwMycsIHtcbiAgICAgICAgY29udHJvbGxlcjogJ1N0ZXBDb250cm9sbGVyJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9zZXR1cC9zdGVwMy5odG1sJ1xuICAgIH0pLndoZW4oJy9zdGVwNCcsIHtcbiAgICAgICAgY29udHJvbGxlcjogJ1N0ZXBDb250cm9sbGVyJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9zZXR1cC9zdGVwNC5odG1sJ1xuICAgIH0pLndoZW4oJy9zdGVwNScsIHtcbiAgICAgICAgY29udHJvbGxlcjogJ0ZpbmlzaENvbnRyb2xsZXInLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NldHVwL3N0ZXA1Lmh0bWwnXG4gICAgfSkub3RoZXJ3aXNlKHsgcmVkaXJlY3RUbzogJy8nfSk7XG59XSk7XG5cbmFwcC5zZXJ2aWNlKCdXaXphcmQnLCBbIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaW5zdGFuY2UgPSBudWxsO1xuXG4gICAgZnVuY3Rpb24gV2l6YXJkKCkge1xuICAgICAgICB0aGlzLnVzZXJuYW1lID0gJyc7XG4gICAgICAgIHRoaXMuZW1haWwgPSAnJztcbiAgICAgICAgdGhpcy5wYXNzd29yZCA9ICcnO1xuICAgIH1cblxuICAgIGluc3RhbmNlID0gbmV3IFdpemFyZCgpO1xuICAgIHJldHVybiBpbnN0YW5jZTtcbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ1N0ZXBDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgJ1dpemFyZCcsIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbiwgV2l6YXJkKSB7XG4gICAgJHNjb3BlLndpemFyZCA9IFdpemFyZDtcblxuICAgICRzY29wZS5vayA9IGZ1bmN0aW9uIChwYWdlLCBiYWQpIHtcbiAgICAgICAgaWYgKCFiYWQpICRsb2NhdGlvbi5wYXRoKHBhZ2UpO1xuICAgIH07XG5cbiAgICAkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICQoJ2lucHV0W2F1dG9mb2N1c10nKS5mb2N1cygpO1xuICAgIH0pO1xufV0pO1xuXG5hcHAuY29udHJvbGxlcignRmluaXNoQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRsb2NhdGlvbicsICckdGltZW91dCcsICdXaXphcmQnLCAnQ2xpZW50JywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCAkdGltZW91dCwgV2l6YXJkLCBDbGllbnQpIHtcbiAgICAkc2NvcGUud2l6YXJkID0gV2l6YXJkO1xuXG4gICAgZnVuY3Rpb24gZmluaXNoKCkge1xuICAgICAgICBDbGllbnQuY3JlYXRlQWRtaW4oJHNjb3BlLndpemFyZC51c2VybmFtZSwgJHNjb3BlLndpemFyZC5wYXNzd29yZCwgJHNjb3BlLndpemFyZC5lbWFpbCwgJHNjb3BlLnNldHVwVG9rZW4sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignSW50ZXJuYWwgZXJyb3InLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL2Vycm9yLmh0bWwnO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnLyc7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgICR0aW1lb3V0KGZpbmlzaCwgMTAwMCk7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdTZXR1cENvbnRyb2xsZXInLCBbJyRzY29wZScsICckbG9jYXRpb24nLCAnQ2xpZW50JywgJ1dpemFyZCcsIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbiwgQ2xpZW50LCBXaXphcmQpIHtcbiAgICAkc2NvcGUuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblxuICAgIC8vIFN0dXBpZCBhbmd1bGFyIGxvY2F0aW9uIHByb3ZpZGVyIGVpdGhlciB3YW50cyBodG1sNSBsb2NhdGlvbiBtb2RlIG9yIG5vdCwgZG8gdGhlIHF1ZXJ5IHBhcnNpbmcgb24gbXkgb3duXG4gICAgdmFyIHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc2xpY2UoMSkuc3BsaXQoJyYnKS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIGl0ZW0uc3BsaXQoJz0nKTsgfSkucmVkdWNlKGZ1bmN0aW9uIChvLCBrKSB7IG9ba1swXV0gPSBrWzFdOyByZXR1cm4gbzsgfSwge30pO1xuXG4gICAgJHNjb3BlLnNldHVwVG9rZW4gPSBzZWFyY2guc2V0dXBUb2tlbjtcblxuICAgIENsaWVudC5pc1NlcnZlckZpcnN0VGltZShmdW5jdGlvbiAoZXJyb3IsIGlzRmlyc3RUaW1lKSB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL2Vycm9yLmh0bWwnO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFpc0ZpcnN0VGltZSkge1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnLyc7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIVdpemFyZC51c2VybmFtZSkgJGxvY2F0aW9uLnBhdGgoJy9zdGVwMScpO1xuXG4gICAgICAgICRzY29wZS5pbml0aWFsaXplZCA9IHRydWU7XG5cbiAgICB9KTtcbn1dKTtcbiIsIid1c2Ugc3RyaWN0JztcblxuLyogZ2xvYmFsIGFuZ3VsYXIgKi9cbi8qIGdsb2JhbCBFdmVudFNvdXJjZSAqL1xuXG5hbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nKS5zZXJ2aWNlKCdDbGllbnQnLCBbJyRodHRwJywgJ21kNScsIGZ1bmN0aW9uICgkaHR0cCwgbWQ1KSB7XG4gICAgdmFyIGNsaWVudCA9IG51bGw7XG5cbiAgICBmdW5jdGlvbiBDbGllbnRFcnJvcihzdGF0dXNDb2RlLCBtZXNzYWdlKSB7XG4gICAgICAgIEVycm9yLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubmFtZSA9IHRoaXMuY29uc3RydWN0b3IubmFtZTtcbiAgICAgICAgdGhpcy5zdGF0dXNDb2RlID0gc3RhdHVzQ29kZTtcbiAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gSlNPTi5zdHJpbmdpZnkobWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSA0MDEpIHJldHVybiBjbGllbnQubG9nb3V0KCk7XG4gICAgICAgICAgICBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gQ2xpZW50KCkge1xuICAgICAgICB0aGlzLl9yZWFkeSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9jb25maWdMaXN0ZW5lciA9IFtdO1xuICAgICAgICB0aGlzLl9yZWFkeUxpc3RlbmVyID0gW107XG4gICAgICAgIHRoaXMuX3VzZXJJbmZvID0ge1xuICAgICAgICAgICAgdXNlcm5hbWU6IG51bGwsXG4gICAgICAgICAgICBlbWFpbDogbnVsbCxcbiAgICAgICAgICAgIGFkbWluOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl90b2tlbiA9IG51bGw7XG4gICAgICAgIHRoaXMuX2NsaWVudElkID0gJ2NpZC13ZWJhZG1pbic7XG4gICAgICAgIHRoaXMuX2NsaWVudFNlY3JldCA9ICd1bnVzZWQnO1xuICAgICAgICB0aGlzLl9jb25maWcgPSB7XG4gICAgICAgICAgICBhcGlTZXJ2ZXJPcmlnaW46IG51bGwsXG4gICAgICAgICAgICB3ZWJTZXJ2ZXJPcmlnaW46IG51bGwsXG4gICAgICAgICAgICBmcWRuOiBudWxsLFxuICAgICAgICAgICAgaXA6IG51bGwsXG4gICAgICAgICAgICByZXZpc2lvbjogbnVsbCxcbiAgICAgICAgICAgIHVwZGF0ZTogeyBib3g6IG51bGwsIGFwcHM6IG51bGwgfSxcbiAgICAgICAgICAgIGlzRGV2OiBmYWxzZSxcbiAgICAgICAgICAgIHByb2dyZXNzOiB7fVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9pbnN0YWxsZWRBcHBzID0gW107XG5cbiAgICAgICAgdGhpcy5zZXRUb2tlbihsb2NhbFN0b3JhZ2UudG9rZW4pO1xuICAgIH1cblxuICAgIENsaWVudC5wcm90b3R5cGUuc2V0UmVhZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9yZWFkeSkgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMuX3JlYWR5ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcmVhZHlMaXN0ZW5lci5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUub25SZWFkeSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICBpZiAodGhpcy5fcmVhZHkpIGNhbGxiYWNrKCk7XG4gICAgICAgIHRoaXMuX3JlYWR5TGlzdGVuZXIucHVzaChjYWxsYmFjayk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUub25Db25maWcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5fY29uZmlnTGlzdGVuZXIucHVzaChjYWxsYmFjayk7XG4gICAgICAgIGNhbGxiYWNrKHRoaXMuX2NvbmZpZyk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuc2V0VXNlckluZm8gPSBmdW5jdGlvbiAodXNlckluZm8pIHtcbiAgICAgICAgLy8gSW4gb3JkZXIgdG8ga2VlcCB0aGUgYW5ndWxhciBiaW5kaW5ncyBhbGl2ZSwgc2V0IGVhY2ggcHJvcGVydHkgaW5kaXZpZHVhbGx5XG4gICAgICAgIHRoaXMuX3VzZXJJbmZvLnVzZXJuYW1lID0gdXNlckluZm8udXNlcm5hbWU7XG4gICAgICAgIHRoaXMuX3VzZXJJbmZvLmVtYWlsID0gdXNlckluZm8uZW1haWw7XG4gICAgICAgIHRoaXMuX3VzZXJJbmZvLmFkbWluID0gISF1c2VySW5mby5hZG1pbjtcbiAgICAgICAgdGhpcy5fdXNlckluZm8uZ3JhdmF0YXIgPSAnaHR0cHM6Ly93d3cuZ3JhdmF0YXIuY29tL2F2YXRhci8nICsgbWQ1LmNyZWF0ZUhhc2godXNlckluZm8uZW1haWwudG9Mb3dlckNhc2UoKSkgKyAnLmpwZz9zPTI0JmQ9bW0nO1xuICAgICAgICB0aGlzLl91c2VySW5mby5ncmF2YXRhckh1Z2UgPSAnaHR0cHM6Ly93d3cuZ3JhdmF0YXIuY29tL2F2YXRhci8nICsgbWQ1LmNyZWF0ZUhhc2godXNlckluZm8uZW1haWwudG9Mb3dlckNhc2UoKSkgKyAnLmpwZz9zPTEyOCZkPW1tJztcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5zZXRDb25maWcgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIC8vIEluIG9yZGVyIHRvIGtlZXAgdGhlIGFuZ3VsYXIgYmluZGluZ3MgYWxpdmUsIHNldCBlYWNoIHByb3BlcnR5IGluZGl2aWR1YWxseSAoVE9ETzoganVzdCB1c2UgYW5ndWxhci5jb3B5ID8pXG4gICAgICAgIHRoaXMuX2NvbmZpZy5hcGlTZXJ2ZXJPcmlnaW4gPSBjb25maWcuYXBpU2VydmVyT3JpZ2luO1xuICAgICAgICB0aGlzLl9jb25maWcud2ViU2VydmVyT3JpZ2luID0gY29uZmlnLndlYlNlcnZlck9yaWdpbjtcbiAgICAgICAgdGhpcy5fY29uZmlnLnZlcnNpb24gPSBjb25maWcudmVyc2lvbjtcbiAgICAgICAgdGhpcy5fY29uZmlnLmZxZG4gPSBjb25maWcuZnFkbjtcbiAgICAgICAgdGhpcy5fY29uZmlnLmlwID0gY29uZmlnLmlwO1xuICAgICAgICB0aGlzLl9jb25maWcucmV2aXNpb24gPSBjb25maWcucmV2aXNpb247XG4gICAgICAgIHRoaXMuX2NvbmZpZy51cGRhdGUgPSBjb25maWcudXBkYXRlO1xuICAgICAgICB0aGlzLl9jb25maWcuaXNEZXYgPSBjb25maWcuaXNEZXY7XG4gICAgICAgIHRoaXMuX2NvbmZpZy5wcm9ncmVzcyA9IGNvbmZpZy5wcm9ncmVzcztcblxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgdGhpcy5fY29uZmlnTGlzdGVuZXIuZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRoYXQuX2NvbmZpZyk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmdldEluc3RhbGxlZEFwcHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnN0YWxsZWRBcHBzO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmdldFVzZXJJbmZvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdXNlckluZm87XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ2V0Q29uZmlnID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlnO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnNldFRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyB0b2tlbjtcbiAgICAgICAgaWYgKCF0b2tlbikgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3Rva2VuJyk7XG4gICAgICAgIGVsc2UgbG9jYWxTdG9yYWdlLnRva2VuID0gdG9rZW47XG4gICAgICAgIHRoaXMuX3Rva2VuID0gdG9rZW47XG4gICAgfTtcblxuICAgIC8qXG4gICAgICogUmVzdCBBUEkgd3JhcHBlcnNcbiAgICAgKi9cbiAgICBDbGllbnQucHJvdG90eXBlLmNvbmZpZyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvY2xvdWRyb24vY29uZmlnJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnVzZXJJbmZvID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLmdldCgnL2FwaS92MS9wcm9maWxlJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmluc3RhbGxBcHAgPSBmdW5jdGlvbiAoaWQsIG1hbmlmZXN0LCBwYXNzd29yZCwgdGl0bGUsIGNvbmZpZywgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICB2YXIgZGF0YSA9IHsgYXBwU3RvcmVJZDogaWQsIG1hbmlmZXN0OiBtYW5pZmVzdCwgcGFzc3dvcmQ6IHBhc3N3b3JkLCBsb2NhdGlvbjogY29uZmlnLmxvY2F0aW9uLCBwb3J0QmluZGluZ3M6IGNvbmZpZy5wb3J0QmluZGluZ3MsIGFjY2Vzc1Jlc3RyaWN0aW9uOiBjb25maWcuYWNjZXNzUmVzdHJpY3Rpb24gfTtcbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9hcHBzL2luc3RhbGwnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMiB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG5cbiAgICAgICAgICAgIC8vIHB1dCBuZXcgYXBwIHdpdGggYW1lbmRlZCB0aXRsZSBpbiBjYWNoZVxuICAgICAgICAgICAgZGF0YS5tYW5pZmVzdCA9IHsgdGl0bGU6IHRpdGxlIH07XG4gICAgICAgICAgICB0aGF0Ll9pbnN0YWxsZWRBcHBzLnB1c2goZGF0YSk7XG5cbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEuaWQpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUudW5pbnN0YWxsQXBwID0gZnVuY3Rpb24gKGFwcElkLCBwYXNzd29yZCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7IHBhc3N3b3JkOiBwYXNzd29yZCB9O1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL2FwcHMvJyArIGFwcElkICsgJy91bmluc3RhbGwnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMikgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuY29uZmlndXJlQXBwID0gZnVuY3Rpb24gKGlkLCBwYXNzd29yZCwgY29uZmlnLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgZGF0YSA9IHsgYXBwSWQ6IGlkLCBwYXNzd29yZDogcGFzc3dvcmQsIGxvY2F0aW9uOiBjb25maWcubG9jYXRpb24sIHBvcnRCaW5kaW5nczogY29uZmlnLnBvcnRCaW5kaW5ncywgYWNjZXNzUmVzdHJpY3Rpb246IGNvbmZpZy5hY2Nlc3NSZXN0cmljdGlvbiB9O1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL2FwcHMvJyArIGlkICsgJy9jb25maWd1cmUnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMikgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUudXBkYXRlQXBwID0gZnVuY3Rpb24gKGlkLCBtYW5pZmVzdCwgcGFzc3dvcmQsIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvYXBwcy8nICsgaWQgKyAnL3VwZGF0ZScsIHsgbWFuaWZlc3Q6IG1hbmlmZXN0LCBwYXNzd29yZDogcGFzc3dvcmQgfSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDIpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnN0YXJ0QXBwID0gZnVuY3Rpb24gKGlkLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgZGF0YSA9IHsgfTtcbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9hcHBzLycgKyBpZCArICcvc3RhcnQnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMikgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuc3RvcEFwcCA9IGZ1bmN0aW9uIChpZCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7IH07XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvYXBwcy8nICsgaWQgKyAnL3N0b3AnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMikgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUudmVyc2lvbiA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvY2xvdWRyb24vc3RhdHVzJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmlzU2VydmVyRmlyc3RUaW1lID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLmdldCgnL2FwaS92MS9jbG91ZHJvbi9zdGF0dXMnKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAwIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsICFkYXRhLmFjdGl2YXRlZCk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5nZXROYWtlZERvbWFpbiA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvc2V0dGluZ3MvbmFrZWRfZG9tYWluJylcbiAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAwIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEuYXBwaWQpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuc2V0TmFrZWREb21haW4gPSBmdW5jdGlvbiAoYXBwaWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvc2V0dGluZ3MvbmFrZWRfZG9tYWluJywgeyBhcHBpZDogYXBwaWQgfSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDQpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmdldEFwcHMgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3YxL2FwcHMnKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhLmFwcHMpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ2V0QXBwID0gZnVuY3Rpb24gKGFwcElkLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgYXBwRm91bmQgPSBudWxsO1xuICAgICAgICB0aGlzLl9pbnN0YWxsZWRBcHBzLnNvbWUoZnVuY3Rpb24gKGFwcCkge1xuICAgICAgICAgICAgaWYgKGFwcC5pZCA9PT0gYXBwSWQpIHtcbiAgICAgICAgICAgICAgICBhcHBGb3VuZCA9IGFwcDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoYXBwRm91bmQpIHJldHVybiBjYWxsYmFjayhudWxsLCBhcHBGb3VuZCk7XG4gICAgICAgIGVsc2UgcmV0dXJuIGNhbGxiYWNrKG5ldyBFcnJvcignQXBwIG5vdCBmb3VuZCcpKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5nZXRBcHBMb2dTdHJlYW0gPSBmdW5jdGlvbiAoYXBwSWQpIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IG5ldyBFdmVudFNvdXJjZSgnL2FwaS92MS9hcHBzLycgKyBhcHBJZCArICcvbG9nc3RyZWFtJyk7XG4gICAgICAgIHJldHVybiBzb3VyY2U7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ2V0QXBwTG9nVXJsID0gZnVuY3Rpb24gKGFwcElkKSB7XG4gICAgICAgIHJldHVybiAnL2FwaS92MS9hcHBzLycgKyBhcHBJZCArICcvbG9ncz9hY2Nlc3NfdG9rZW49JyArIHRoaXMuX3Rva2VuO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnNldEFkbWluID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBhZG1pbiwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHBheWxvYWQgPSB7XG4gICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICBhZG1pbjogYWRtaW5cbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL3VzZXJzLycgKyB1c2VybmFtZSArICcvYWRtaW4nLCBwYXlsb2FkKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwNCkgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuY3JlYXRlQWRtaW4gPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkLCBlbWFpbCwgc2V0dXBUb2tlbiwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHBheWxvYWQgPSB7XG4gICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQsXG4gICAgICAgICAgICBlbWFpbDogZW1haWxcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9jbG91ZHJvbi9hY3RpdmF0ZT9zZXR1cFRva2VuPScgKyBzZXR1cFRva2VuLCBwYXlsb2FkKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAxIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcblxuICAgICAgICAgICAgdGhhdC5zZXRUb2tlbihkYXRhLnRva2VuKTtcbiAgICAgICAgICAgIHRoYXQuc2V0VXNlckluZm8oeyB1c2VybmFtZTogdXNlcm5hbWUsIGVtYWlsOiBlbWFpbCwgYWRtaW46IHRydWUgfSk7XG5cbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEuYWN0aXZhdGVkKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmxpc3RVc2VycyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvdXNlcnMnKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAwIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ2V0T0F1dGhDbGllbnRzID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLmdldCgnL2FwaS92MS9vYXV0aC9jbGllbnRzJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhLmNsaWVudHMpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZGVsVG9rZW5zQnlDbGllbnRJZCA9IGZ1bmN0aW9uIChpZCwgY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAuZGVsZXRlKCcvYXBpL3YxL29hdXRoL2NsaWVudHMvJyArIGlkICsgJy90b2tlbnMnKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjA0KSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAocGFzc3dvcmQsIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvY2xvdWRyb24vdXBkYXRlJywgeyBwYXNzd29yZDogcGFzc3dvcmQgfSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMiB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnJlYm9vdCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvY2xvdWRyb24vcmVib290Jykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMiB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmJhY2t1cCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL2Nsb3Vkcm9uL2JhY2t1cHMnKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAyIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuc2V0Q2VydGlmaWNhdGUgPSBmdW5jdGlvbiAoY2VydGlmaWNhdGVGaWxlLCBrZXlGaWxlLCBjYWxsYmFjaykge1xuICAgICAgICBjb25zb2xlLmxvZygnd2lsbCBzZXQgY2VydGlmaWNhdGUnKTtcblxuICAgICAgICB2YXIgZmQgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgZmQuYXBwZW5kKCdjZXJ0aWZpY2F0ZScsIGNlcnRpZmljYXRlRmlsZSk7XG4gICAgICAgIGZkLmFwcGVuZCgna2V5Jywga2V5RmlsZSk7XG5cbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9jbG91ZHJvbi9jZXJ0aWZpY2F0ZScsIGZkLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiB1bmRlZmluZWQgfSxcbiAgICAgICAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IGFuZ3VsYXIuaWRlbnRpdHlcbiAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMikgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ3JhcGhzID0gZnVuY3Rpb24gKHRhcmdldHMsIGZyb20sIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRhcmdldHMsXG4gICAgICAgICAgICAgICAgZm9ybWF0OiAnanNvbicsXG4gICAgICAgICAgICAgICAgZnJvbTogZnJvbVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwLmdldCgnL2FwaS92MS9jbG91ZHJvbi9ncmFwaHMnLCBjb25maWcpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAwIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuY3JlYXRlVXNlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgZW1haWwsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICAgICAgZW1haWw6IGVtYWlsXG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS91c2VycycsIGRhdGEpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDEgfHwgdHlwZW9mIGRhdGEgIT09ICdvYmplY3QnKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5yZW1vdmVVc2VyID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cCh7IG1ldGhvZDogJ0RFTEVURScsIHVybDogJy9hcGkvdjEvdXNlcnMvJyArIHVzZXJuYW1lLCBkYXRhOiBkYXRhLCBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfX0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDQpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmNoYW5nZVBhc3N3b3JkID0gZnVuY3Rpb24gKGN1cnJlbnRQYXNzd29yZCwgbmV3UGFzc3dvcmQsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgcGFzc3dvcmQ6IGN1cnJlbnRQYXNzd29yZCxcbiAgICAgICAgICAgIG5ld1Bhc3N3b3JkOiBuZXdQYXNzd29yZFxuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvdXNlcnMvJyArIHRoaXMuX3VzZXJJbmZvLnVzZXJuYW1lICsgJy9wYXNzd29yZCcsIGRhdGEpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDQpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnJlZnJlc2hDb25maWcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgIGNhbGxiYWNrID0gdHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nID8gY2FsbGJhY2sgOiBmdW5jdGlvbiAoKSB7fTtcblxuICAgICAgICB0aGlzLmNvbmZpZyhmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKGVycm9yKSByZXR1cm4gY2FsbGJhY2soZXJyb3IpO1xuXG4gICAgICAgICAgICB0aGF0LnNldENvbmZpZyhyZXN1bHQpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnJlZnJlc2hJbnN0YWxsZWRBcHBzID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICBjYWxsYmFjayA9IHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJyA/IGNhbGxiYWNrIDogZnVuY3Rpb24gKCkge307XG5cbiAgICAgICAgdGhpcy5nZXRBcHBzKGZ1bmN0aW9uIChlcnJvciwgYXBwcykge1xuICAgICAgICAgICAgaWYgKGVycm9yKSByZXR1cm4gY2FsbGJhY2soZXJyb3IpO1xuXG4gICAgICAgICAgICAvLyBpbnNlcnQgb3IgdXBkYXRlIG5ldyBhcHBzXG4gICAgICAgICAgICBhcHBzLmZvckVhY2goZnVuY3Rpb24gKGFwcCkge1xuICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGF0Ll9pbnN0YWxsZWRBcHBzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGF0Ll9pbnN0YWxsZWRBcHBzW2ldLmlkID09PSBhcHAuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmNvcHkoYXBwLCB0aGF0Ll9pbnN0YWxsZWRBcHBzW2ZvdW5kXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5faW5zdGFsbGVkQXBwcy5wdXNoKGFwcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGZpbHRlciBvdXQgb2xkIGVudHJpZXMsIGdvaW5nIGJhY2t3YXJkcyB0byBhbGxvdyBzcGxpY2luZ1xuICAgICAgICAgICAgZm9yKHZhciBpID0gdGhhdC5faW5zdGFsbGVkQXBwcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICAgICAgICAgIGlmICghYXBwcy5zb21lKGZ1bmN0aW9uIChlbGVtKSB7IHJldHVybiAoZWxlbS5pZCA9PT0gdGhhdC5faW5zdGFsbGVkQXBwc1tpXS5pZCk7IH0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX2luc3RhbGxlZEFwcHMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNldFRva2VuKG51bGwpO1xuICAgICAgICB0aGlzLl91c2VySW5mbyA9IHt9O1xuXG4gICAgICAgIC8vIGxvZ291dCBmcm9tIE9BdXRoIHNlc3Npb25cbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL2FwaS92MS9zZXNzaW9uL2xvZ291dCc7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZXhjaGFuZ2VDb2RlRm9yVG9rZW4gPSBmdW5jdGlvbiAoYXV0aENvZGUsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgZ3JhbnRfdHlwZTogJ2F1dGhvcml6YXRpb25fY29kZScsXG4gICAgICAgICAgICBjb2RlOiBhdXRoQ29kZSxcbiAgICAgICAgICAgIHJlZGlyZWN0X3VyaTogd2luZG93LmxvY2F0aW9uLm9yaWdpbixcbiAgICAgICAgICAgIGNsaWVudF9pZDogdGhpcy5fY2xpZW50SWQsXG4gICAgICAgICAgICBjbGllbnRfc2VjcmV0OiB0aGlzLl9jbGllbnRTZWNyZXRcbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL29hdXRoL3Rva2VuP3Jlc3BvbnNlX3R5cGU9dG9rZW4mY2xpZW50X2lkPScgKyB0aGlzLl9jbGllbnRJZCwgZGF0YSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG5cbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEuYWNjZXNzX3Rva2VuKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBjbGllbnQgPSBuZXcgQ2xpZW50KCk7XG4gICAgcmV0dXJuIGNsaWVudDtcbn1dKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==