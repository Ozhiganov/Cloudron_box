"use strict";var app=angular.module("Application",["ngRoute","ngAnimate","angular-md5"]);app.directive("ngEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.ngEnter)}),t.preventDefault())})}}),app.config(["$routeProvider",function(e){e.when("/",{redirectTo:"/step1"}).when("/step1",{controller:"StepController",templateUrl:"views/setup/step1.html"}).when("/step2",{controller:"StepController",templateUrl:"views/setup/step2.html"}).when("/step3",{controller:"StepController",templateUrl:"views/setup/step3.html"}).when("/step4",{controller:"StepController",templateUrl:"views/setup/step4.html"}).when("/step5",{controller:"FinishController",templateUrl:"views/setup/step5.html"}).otherwise({redirectTo:"/"})}]),app.service("Wizard",[function(){function e(){this.username="",this.email="",this.password=""}var t=null;return t=new e}]),app.controller("StepController",["$scope","$location","Wizard",function(e,t,n){e.wizard=n,e.ok=function(e,n){n||t.path(e)},e.$on("$viewContentLoaded",function(){$("input[autofocus]").focus()})}]),app.controller("FinishController",["$scope","$location","$timeout","Wizard","Client",function(e,t,n,o,r){function i(){r.createAdmin(e.wizard.username,e.wizard.password,e.wizard.email,e.setupToken,function(e){return e?(console.error("Internal error",e),void(window.location.href="/error.html")):void(window.location.href="/")})}e.wizard=o,n(i,1e3)}]),app.controller("SetupController",["$scope","$location","Client","Wizard",function(e,t,n,o){e.initialized=!1;var r=decodeURIComponent(window.location.search).slice(1).split("&").map(function(e){return e.split("=")}).reduce(function(e,t){return e[t[0]]=t[1],e},{});e.setupToken=r.setupToken,n.isServerFirstTime(function(n,r){return n?void(window.location.href="/error.html"):r?(o.username||t.path("/step1"),void(e.initialized=!0)):void(window.location.href="/")})}]),angular.module("Application").service("Client",["$http","md5",function(e,t){function n(e,t){Error.call(this),this.name=this.constructor.name,this.statusCode=e,this.message="string"==typeof t?t:JSON.stringify(t)}function o(e){return function(t,o){return 401===o?i.logout():void e(new n(o,t))}}function r(){this._ready=!1,this._configListener=[],this._readyListener=[],this._userInfo={username:null,email:null,admin:!1},this._token=null,this._clientId="cid-webadmin",this._clientSecret="unused",this._config={apiServerOrigin:null,webServerOrigin:null,fqdn:null,ip:null,revision:null,update:{box:null,apps:null},isDev:!1,progress:{},isCustomDomain:!1},this._installedApps=[],this.setToken(localStorage.token)}var i=null;return r.prototype.setReady=function(){this._ready||(this._ready=!0,this._readyListener.forEach(function(e){e()}))},r.prototype.onReady=function(e){this._ready&&e(),this._readyListener.push(e)},r.prototype.onConfig=function(e){this._configListener.push(e),e(this._config)},r.prototype.setUserInfo=function(e){this._userInfo.username=e.username,this._userInfo.email=e.email,this._userInfo.admin=!!e.admin,this._userInfo.gravatar="https://www.gravatar.com/avatar/"+t.createHash(e.email.toLowerCase())+".jpg?s=24&d=mm",this._userInfo.gravatarHuge="https://www.gravatar.com/avatar/"+t.createHash(e.email.toLowerCase())+".jpg?s=128&d=mm"},r.prototype.setConfig=function(e){this._config.apiServerOrigin=e.apiServerOrigin,this._config.webServerOrigin=e.webServerOrigin,this._config.version=e.version,this._config.fqdn=e.fqdn,this._config.ip=e.ip,this._config.revision=e.revision,this._config.update=e.update,this._config.isDev=e.isDev,this._config.progress=e.progress,this._config.isCustomDomain=e.isCustomDomain;var t=this;this._configListener.forEach(function(e){e(t._config)})},r.prototype.getInstalledApps=function(){return this._installedApps},r.prototype.getUserInfo=function(){return this._userInfo},r.prototype.getConfig=function(){return this._config},r.prototype.setToken=function(t){e.defaults.headers.common.Authorization="Bearer "+t,t?localStorage.token=t:localStorage.removeItem("token"),this._token=t},r.prototype.config=function(t){e.get("/api/v1/cloudron/config").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.userInfo=function(t){e.get("/api/v1/profile").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.installApp=function(t,r,i,s,p,u){var a=this,c={appStoreId:t,manifest:r,password:i,location:p.location,portBindings:p.portBindings,accessRestriction:p.accessRestriction};e.post("/api/v1/apps/install",c).success(function(e,t){return 202!==t||"object"!=typeof e?u(new n(t,e)):(e.manifest={title:s},a._installedApps.push(e),void u(null,e.id))}).error(o(u))},r.prototype.uninstallApp=function(t,r,i){var s={password:r};e.post("/api/v1/apps/"+t+"/uninstall",s).success(function(e,t){return 202!==t?i(new n(t,e)):void i(null)}).error(o(i))},r.prototype.configureApp=function(t,r,i,s){var p={appId:t,password:r,location:i.location,portBindings:i.portBindings,accessRestriction:i.accessRestriction};e.post("/api/v1/apps/"+t+"/configure",p).success(function(e,t){return 202!==t?s(new n(t,e)):void s(null)}).error(o(s))},r.prototype.updateApp=function(t,r,i,s){e.post("/api/v1/apps/"+t+"/update",{manifest:r,password:i}).success(function(e,t){return 202!==t?s(new n(t,e)):void s(null)}).error(o(s))},r.prototype.startApp=function(t,r){var i={};e.post("/api/v1/apps/"+t+"/start",i).success(function(e,t){return 202!==t?r(new n(t,e)):void r(null)}).error(o(r))},r.prototype.stopApp=function(t,r){var i={};e.post("/api/v1/apps/"+t+"/stop",i).success(function(e,t){return 202!==t?r(new n(t,e)):void r(null)}).error(o(r))},r.prototype.version=function(t){e.get("/api/v1/cloudron/status").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.isServerFirstTime=function(t){e.get("/api/v1/cloudron/status").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,!e.activated)}).error(o(t))},r.prototype.getNakedDomain=function(t){e.get("/api/v1/settings/naked_domain").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e.appid)}).error(o(t))},r.prototype.setNakedDomain=function(t,r){e.post("/api/v1/settings/naked_domain",{appid:t}).success(function(e,t){return 204!==t?r(new n(t)):void r(null)}).error(o(r))},r.prototype.getApps=function(t){e.get("/api/v1/apps").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e.apps)}).error(o(t))},r.prototype.getApp=function(e,t){var n=null;return this._installedApps.some(function(t){return t.id===e?(n=t,!0):!1}),n?t(null,n):t(new Error("App not found"))},r.prototype.getAppLogStream=function(e){var t=new EventSource("/api/v1/apps/"+e+"/logstream");return t},r.prototype.getAppLogUrl=function(e){return"/api/v1/apps/"+e+"/logs?access_token="+this._token},r.prototype.setAdmin=function(t,r,i){var s={username:t,admin:r};e.post("/api/v1/users/"+t+"/admin",s).success(function(e,t){return 204!==t?i(new n(t,e)):void i(null)}).error(o(i))},r.prototype.createAdmin=function(t,r,i,s,p){var u={username:t,password:r,email:i},a=this;e.post("/api/v1/cloudron/activate?setupToken="+s,u).success(function(e,o){return 201!==o||"object"!=typeof e?p(new n(o,e)):(a.setToken(e.token),a.setUserInfo({username:t,email:i,admin:!0}),void p(null,e.activated))}).error(o(p))},r.prototype.listUsers=function(t){e.get("/api/v1/users").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.getOAuthClients=function(t){e.get("/api/v1/oauth/clients").success(function(e,o){return 200!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e.clients)}).error(o(t))},r.prototype.delTokensByClientId=function(t,r){e["delete"]("/api/v1/oauth/clients/"+t+"/tokens").success(function(e,t){return 204!==t?r(new n(t,e)):void r(null)}).error(o(r))},r.prototype.update=function(t,r){e.post("/api/v1/cloudron/update",{password:t}).success(function(e,t){return 202!==t||"object"!=typeof e?r(new n(t,e)):void r(null,e)}).error(o(r))},r.prototype.reboot=function(t){e.get("/api/v1/cloudron/reboot").success(function(e,o){return 202!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.backup=function(t){e.post("/api/v1/cloudron/backups").success(function(e,o){return 202!==o||"object"!=typeof e?t(new n(o,e)):void t(null,e)}).error(o(t))},r.prototype.setCertificate=function(t,r,i){console.log("will set certificate");var s=new FormData;s.append("certificate",t),s.append("key",r),e.post("/api/v1/cloudron/certificate",s,{headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(e,t){return 202!==t?i(new n(t,e)):void i(null)}).error(o(i))},r.prototype.graphs=function(t,r,i){var s={params:{target:t,format:"json",from:r}};e.get("/api/v1/cloudron/graphs",s).success(function(e,t){return 200!==t||"object"!=typeof e?i(new n(t,e)):void i(null,e)}).error(o(i))},r.prototype.createUser=function(t,r,i){var s={username:t,email:r};e.post("/api/v1/users",s).success(function(e,t){return 201!==t||"object"!=typeof e?i(new n(t,e)):void i(null,e)}).error(o(i))},r.prototype.removeUser=function(t,r,i){var s={username:t,password:r};e({method:"DELETE",url:"/api/v1/users/"+t,data:s,headers:{"Content-Type":"application/json"}}).success(function(e,t){return 204!==t?i(new n(t,e)):void i(null)}).error(o(i))},r.prototype.changePassword=function(t,r,i){var s={password:t,newPassword:r};e.post("/api/v1/users/"+this._userInfo.username+"/password",s).success(function(e,t){return 204!==t?i(new n(t,e)):void i(null,e)}).error(o(i))},r.prototype.changeEmail=function(t,r,i){var s={password:r,email:t};e.put("/api/v1/users/"+this._userInfo.username,s).success(function(e,t){return 204!==t?i(new n(t,e)):void i(null,e)}).error(o(i))},r.prototype.refreshConfig=function(e){var t=this;e="function"==typeof e?e:function(){},this.config(function(n,o){return n?e(n):(t.setConfig(o),void e(null))})},r.prototype.refreshInstalledApps=function(e){var t=this;e="function"==typeof e?e:function(){},this.getApps(function(n,o){if(n)return e(n);o.forEach(function(e){for(var n=!1,o=0;o<t._installedApps.length;++o)if(t._installedApps[o].id===e.id){n=o;break}n!==!1?angular.copy(e,t._installedApps[n]):t._installedApps.push(e)});for(var r=t._installedApps.length-1;r>=0;--r)o.some(function(e){return e.id===t._installedApps[r].id})||t._installedApps.splice(r,1);e(null)})},r.prototype.logout=function(){this.setToken(null),this._userInfo={},window.location.href="/api/v1/session/logout"},r.prototype.exchangeCodeForToken=function(t,r){var i={grant_type:"authorization_code",code:t,redirect_uri:window.location.origin,client_id:this._clientId,client_secret:this._clientSecret};e.post("/api/v1/oauth/token?response_type=token&client_id="+this._clientId,i).success(function(e,t){return 200!==t||"object"!=typeof e?r(new n(t,e)):void r(null,e.access_token)}).error(o(r))},i=new r}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNldHVwLmpzIiwiY2xpZW50LmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJkaXJlY3RpdmUiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRycyIsImJpbmQiLCJldmVudCIsIndoaWNoIiwiJGFwcGx5IiwiJGV2YWwiLCJuZ0VudGVyIiwicHJldmVudERlZmF1bHQiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJyZWRpcmVjdFRvIiwiY29udHJvbGxlciIsInRlbXBsYXRlVXJsIiwib3RoZXJ3aXNlIiwic2VydmljZSIsIldpemFyZCIsInRoaXMiLCJ1c2VybmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJpbnN0YW5jZSIsIiRzY29wZSIsIiRsb2NhdGlvbiIsIndpemFyZCIsIm9rIiwicGFnZSIsImJhZCIsInBhdGgiLCIkb24iLCIkIiwiZm9jdXMiLCIkdGltZW91dCIsIkNsaWVudCIsImZpbmlzaCIsImNyZWF0ZUFkbWluIiwic2V0dXBUb2tlbiIsImVycm9yIiwiY29uc29sZSIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsImluaXRpYWxpemVkIiwic2VhcmNoIiwiZGVjb2RlVVJJQ29tcG9uZW50Iiwic2xpY2UiLCJzcGxpdCIsIm1hcCIsIml0ZW0iLCJyZWR1Y2UiLCJvIiwiayIsImlzU2VydmVyRmlyc3RUaW1lIiwiaXNGaXJzdFRpbWUiLCIkaHR0cCIsIm1kNSIsIkNsaWVudEVycm9yIiwic3RhdHVzQ29kZSIsIm1lc3NhZ2UiLCJFcnJvciIsImNhbGwiLCJuYW1lIiwiY29uc3RydWN0b3IiLCJKU09OIiwic3RyaW5naWZ5IiwiZGVmYXVsdEVycm9ySGFuZGxlciIsImNhbGxiYWNrIiwiZGF0YSIsInN0YXR1cyIsImNsaWVudCIsImxvZ291dCIsIl9yZWFkeSIsIl9jb25maWdMaXN0ZW5lciIsIl9yZWFkeUxpc3RlbmVyIiwiX3VzZXJJbmZvIiwiYWRtaW4iLCJfdG9rZW4iLCJfY2xpZW50SWQiLCJfY2xpZW50U2VjcmV0IiwiX2NvbmZpZyIsImFwaVNlcnZlck9yaWdpbiIsIndlYlNlcnZlck9yaWdpbiIsImZxZG4iLCJpcCIsInJldmlzaW9uIiwidXBkYXRlIiwiYm94IiwiYXBwcyIsImlzRGV2IiwicHJvZ3Jlc3MiLCJpc0N1c3RvbURvbWFpbiIsIl9pbnN0YWxsZWRBcHBzIiwic2V0VG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJ0b2tlbiIsInByb3RvdHlwZSIsInNldFJlYWR5IiwiZm9yRWFjaCIsIm9uUmVhZHkiLCJwdXNoIiwib25Db25maWciLCJzZXRVc2VySW5mbyIsInVzZXJJbmZvIiwiZ3JhdmF0YXIiLCJjcmVhdGVIYXNoIiwidG9Mb3dlckNhc2UiLCJncmF2YXRhckh1Z2UiLCJzZXRDb25maWciLCJ2ZXJzaW9uIiwidGhhdCIsImdldEluc3RhbGxlZEFwcHMiLCJnZXRVc2VySW5mbyIsImdldENvbmZpZyIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsIkF1dGhvcml6YXRpb24iLCJyZW1vdmVJdGVtIiwiZ2V0Iiwic3VjY2VzcyIsImluc3RhbGxBcHAiLCJpZCIsIm1hbmlmZXN0IiwidGl0bGUiLCJhcHBTdG9yZUlkIiwicG9ydEJpbmRpbmdzIiwiYWNjZXNzUmVzdHJpY3Rpb24iLCJwb3N0IiwidW5pbnN0YWxsQXBwIiwiYXBwSWQiLCJjb25maWd1cmVBcHAiLCJ1cGRhdGVBcHAiLCJzdGFydEFwcCIsInN0b3BBcHAiLCJhY3RpdmF0ZWQiLCJnZXROYWtlZERvbWFpbiIsImFwcGlkIiwic2V0TmFrZWREb21haW4iLCJnZXRBcHBzIiwiZ2V0QXBwIiwiYXBwRm91bmQiLCJzb21lIiwiZ2V0QXBwTG9nU3RyZWFtIiwic291cmNlIiwiRXZlbnRTb3VyY2UiLCJnZXRBcHBMb2dVcmwiLCJzZXRBZG1pbiIsInBheWxvYWQiLCJsaXN0VXNlcnMiLCJnZXRPQXV0aENsaWVudHMiLCJjbGllbnRzIiwiZGVsVG9rZW5zQnlDbGllbnRJZCIsInJlYm9vdCIsImJhY2t1cCIsInNldENlcnRpZmljYXRlIiwiY2VydGlmaWNhdGVGaWxlIiwia2V5RmlsZSIsImxvZyIsImZkIiwiRm9ybURhdGEiLCJhcHBlbmQiLCJDb250ZW50LVR5cGUiLCJ1bmRlZmluZWQiLCJ0cmFuc2Zvcm1SZXF1ZXN0IiwiaWRlbnRpdHkiLCJncmFwaHMiLCJ0YXJnZXRzIiwiZnJvbSIsInBhcmFtcyIsInRhcmdldCIsImZvcm1hdCIsImNyZWF0ZVVzZXIiLCJyZW1vdmVVc2VyIiwibWV0aG9kIiwidXJsIiwiY2hhbmdlUGFzc3dvcmQiLCJjdXJyZW50UGFzc3dvcmQiLCJuZXdQYXNzd29yZCIsImNoYW5nZUVtYWlsIiwicHV0IiwicmVmcmVzaENvbmZpZyIsInJlc3VsdCIsInJlZnJlc2hJbnN0YWxsZWRBcHBzIiwiZm91bmQiLCJpIiwibGVuZ3RoIiwiY29weSIsImVsZW0iLCJzcGxpY2UiLCJleGNoYW5nZUNvZGVGb3JUb2tlbiIsImF1dGhDb2RlIiwiZ3JhbnRfdHlwZSIsImNvZGUiLCJyZWRpcmVjdF91cmkiLCJvcmlnaW4iLCJjbGllbnRfaWQiLCJjbGllbnRfc2VjcmV0IiwiYWNjZXNzX3Rva2VuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUdBLElBQUFBLEtBQUFDLFFBQUFDLE9BQUEsZUFBQSxVQUFBLFlBQUEsZUFFQUYsS0FBQUcsVUFBQSxVQUFBLFdBQ0EsTUFBQSxVQUFBQyxFQUFBQyxFQUFBQyxHQUNBRCxFQUFBRSxLQUFBLG1CQUFBLFNBQUFDLEdBQ0EsS0FBQUEsRUFBQUMsUUFDQUwsRUFBQU0sT0FBQSxXQUNBTixFQUFBTyxNQUFBTCxFQUFBTSxXQUdBSixFQUFBSyx1QkFPQWIsSUFBQWMsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUFBQyxLQUFBLEtBQ0FDLFdBQUEsV0FDQUQsS0FBQSxVQUNBRSxXQUFBLGlCQUNBQyxZQUFBLDJCQUNBSCxLQUFBLFVBQ0FFLFdBQUEsaUJBQ0FDLFlBQUEsMkJBQ0FILEtBQUEsVUFDQUUsV0FBQSxpQkFDQUMsWUFBQSwyQkFDQUgsS0FBQSxVQUNBRSxXQUFBLGlCQUNBQyxZ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QixPQUFBLFdBQ0FyRCxLQUFBMkUsU0FBQSxNQUNBM0UsS0FBQXlELGFBR0FuQyxPQUFBQyxTQUFBQyxLQUFBLDBCQUdBUixFQUFBOEQsVUFBQThGLHFCQUFBLFNBQUFDLEVBQUE1SCxHQUNBLEdBQUFDLElBQ0E0SCxXQUFBLHFCQUNBQyxLQUFBRixFQUNBRyxhQUFBMUosT0FBQUMsU0FBQTBKLE9BQ0FDLFVBQUFsTCxLQUFBNEQsVUFDQXVILGNBQUFuTCxLQUFBNkQsY0FHQXhCLEdBQUF5RSxLQUFBLHFEQUFBOUcsS0FBQTRELFVBQUFWLEdBQUFvRCxRQUFBLFNBQUFwRCxFQUFBQyxHQUNBLE1BQUEsT0FBQUEsR0FBQSxnQkFBQUQsR0FBQUQsRUFBQSxHQUFBVixHQUFBWSxFQUFBRCxRQUVBRCxHQUFBLEtBQUFDLEVBQUFrSSxnQkFDQWhLLE1BQUE0QixFQUFBQyxLQUdBRyxFQUFBLEdBQUFwQyIsImZpbGUiOiJzZXR1cC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLy8gY3JlYXRlIG1haW4gYXBwbGljYXRpb24gbW9kdWxlXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJywgWyduZ1JvdXRlJywgJ25nQW5pbWF0ZScsICdhbmd1bGFyLW1kNSddKTtcblxuYXBwLmRpcmVjdGl2ZSgnbmdFbnRlcicsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICBlbGVtZW50LmJpbmQoJ2tleWRvd24ga2V5cHJlc3MnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGlmKGV2ZW50LndoaWNoID09PSAxMykge1xuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKXtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGV2YWwoYXR0cnMubmdFbnRlcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xufSk7XG5cbi8vIHNldHVwIGFsbCBtYWpvciBhcHBsaWNhdGlvbiByb3V0ZXNcbmFwcC5jb25maWcoWyckcm91dGVQcm92aWRlcicsIGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xuICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy8nLCB7XG4gICAgICAgIHJlZGlyZWN0VG86ICcvc3RlcDEnXG4gICAgfSkud2hlbignL3N0ZXAxJywge1xuICAgICAgICBjb250cm9sbGVyOiAnU3RlcENvbnRyb2xsZXInLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NldHVwL3N0ZXAxLmh0bWwnXG4gICAgfSkud2hlbignL3N0ZXAyJywge1xuICAgICAgICBjb250cm9sbGVyOiAnU3RlcENvbnRyb2xsZXInLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NldHVwL3N0ZXAyLmh0bWwnXG4gICAgfSkud2hlbignL3N0ZXAzJywge1xuICAgICAgICBjb250cm9sbGVyOiAnU3RlcENvbnRyb2xsZXInLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NldHVwL3N0ZXAzLmh0bWwnXG4gICAgfSkud2hlbignL3N0ZXA0Jywge1xuICAgICAgICBjb250cm9sbGVyOiAnU3RlcENvbnRyb2xsZXInLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NldHVwL3N0ZXA0Lmh0bWwnXG4gICAgfSkud2hlbignL3N0ZXA1Jywge1xuICAgICAgICBjb250cm9sbGVyOiAnRmluaXNoQ29udHJvbGxlcicsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3Mvc2V0dXAvc3RlcDUuaHRtbCdcbiAgICB9KS5vdGhlcndpc2UoeyByZWRpcmVjdFRvOiAnLyd9KTtcbn1dKTtcblxuYXBwLnNlcnZpY2UoJ1dpemFyZCcsIFsgZnVuY3Rpb24gKCkge1xuICAgIHZhciBpbnN0YW5jZSA9IG51bGw7XG5cbiAgICBmdW5jdGlvbiBXaXphcmQoKSB7XG4gICAgICAgIHRoaXMudXNlcm5hbWUgPSAnJztcbiAgICAgICAgdGhpcy5lbWFpbCA9ICcnO1xuICAgICAgICB0aGlzLnBhc3N3b3JkID0gJyc7XG4gICAgfVxuXG4gICAgaW5zdGFuY2UgPSBuZXcgV2l6YXJkKCk7XG4gICAgcmV0dXJuIGluc3RhbmNlO1xufV0pO1xuXG5hcHAuY29udHJvbGxlcignU3RlcENvbnRyb2xsZXInLCBbJyRzY29wZScsICckbG9jYXRpb24nLCAnV2l6YXJkJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCBXaXphcmQpIHtcbiAgICAkc2NvcGUud2l6YXJkID0gV2l6YXJkO1xuXG4gICAgJHNjb3BlLm9rID0gZnVuY3Rpb24gKHBhZ2UsIGJhZCkge1xuICAgICAgICBpZiAoIWJhZCkgJGxvY2F0aW9uLnBhdGgocGFnZSk7XG4gICAgfTtcblxuICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCgnaW5wdXRbYXV0b2ZvY3VzXScpLmZvY3VzKCk7XG4gICAgfSk7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdGaW5pc2hDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgJyR0aW1lb3V0JywgJ1dpemFyZCcsICdDbGllbnQnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sICR0aW1lb3V0LCBXaXphcmQsIENsaWVudCkge1xuICAgICRzY29wZS53aXphcmQgPSBXaXphcmQ7XG5cbiAgICBmdW5jdGlvbiBmaW5pc2goKSB7XG4gICAgICAgIENsaWVudC5jcmVhdGVBZG1pbigkc2NvcGUud2l6YXJkLnVzZXJuYW1lLCAkc2NvcGUud2l6YXJkLnBhc3N3b3JkLCAkc2NvcGUud2l6YXJkLmVtYWlsLCAkc2NvcGUuc2V0dXBUb2tlbiwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdJbnRlcm5hbCBlcnJvcicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvZXJyb3IuaHRtbCc7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvJztcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgJHRpbWVvdXQoZmluaXNoLCAxMDAwKTtcbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ1NldHVwQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRsb2NhdGlvbicsICdDbGllbnQnLCAnV2l6YXJkJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCBDbGllbnQsIFdpemFyZCkge1xuICAgICRzY29wZS5pbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gICAgLy8gU3R1cGlkIGFuZ3VsYXIgbG9jYXRpb24gcHJvdmlkZXIgZWl0aGVyIHdhbnRzIGh0bWw1IGxvY2F0aW9uIG1vZGUgb3Igbm90LCBkbyB0aGUgcXVlcnkgcGFyc2luZyBvbiBteSBvd25cbiAgICB2YXIgc2VhcmNoID0gZGVjb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpLnNsaWNlKDEpLnNwbGl0KCcmJykubWFwKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBpdGVtLnNwbGl0KCc9Jyk7IH0pLnJlZHVjZShmdW5jdGlvbiAobywgaykgeyBvW2tbMF1dID0ga1sxXTsgcmV0dXJuIG87IH0sIHt9KTtcblxuICAgICRzY29wZS5zZXR1cFRva2VuID0gc2VhcmNoLnNldHVwVG9rZW47XG5cbiAgICBDbGllbnQuaXNTZXJ2ZXJGaXJzdFRpbWUoZnVuY3Rpb24gKGVycm9yLCBpc0ZpcnN0VGltZSkge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9lcnJvci5odG1sJztcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaXNGaXJzdFRpbWUpIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy8nO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFXaXphcmQudXNlcm5hbWUpICRsb2NhdGlvbi5wYXRoKCcvc3RlcDEnKTtcblxuICAgICAgICAkc2NvcGUuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXG4gICAgfSk7XG59XSk7XG4iLCIndXNlIHN0cmljdCc7XG5cbi8qIGdsb2JhbCBhbmd1bGFyICovXG4vKiBnbG9iYWwgRXZlbnRTb3VyY2UgKi9cblxuYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJykuc2VydmljZSgnQ2xpZW50JywgWyckaHR0cCcsICdtZDUnLCBmdW5jdGlvbiAoJGh0dHAsIG1kNSkge1xuICAgIHZhciBjbGllbnQgPSBudWxsO1xuXG4gICAgZnVuY3Rpb24gQ2xpZW50RXJyb3Ioc3RhdHVzQ29kZSwgbWVzc2FnZSkge1xuICAgICAgICBFcnJvci5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLm5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgICAgIHRoaXMuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gICAgICAgIGlmICh0eXBlb2YgbWVzc2FnZSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gNDAxKSByZXR1cm4gY2xpZW50LmxvZ291dCgpO1xuICAgICAgICAgICAgY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIENsaWVudCgpIHtcbiAgICAgICAgdGhpcy5fcmVhZHkgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY29uZmlnTGlzdGVuZXIgPSBbXTtcbiAgICAgICAgdGhpcy5fcmVhZHlMaXN0ZW5lciA9IFtdO1xuICAgICAgICB0aGlzLl91c2VySW5mbyA9IHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiBudWxsLFxuICAgICAgICAgICAgZW1haWw6IG51bGwsXG4gICAgICAgICAgICBhZG1pbjogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fdG9rZW4gPSBudWxsO1xuICAgICAgICB0aGlzLl9jbGllbnRJZCA9ICdjaWQtd2ViYWRtaW4nO1xuICAgICAgICB0aGlzLl9jbGllbnRTZWNyZXQgPSAndW51c2VkJztcbiAgICAgICAgdGhpcy5fY29uZmlnID0ge1xuICAgICAgICAgICAgYXBpU2VydmVyT3JpZ2luOiBudWxsLFxuICAgICAgICAgICAgd2ViU2VydmVyT3JpZ2luOiBudWxsLFxuICAgICAgICAgICAgZnFkbjogbnVsbCxcbiAgICAgICAgICAgIGlwOiBudWxsLFxuICAgICAgICAgICAgcmV2aXNpb246IG51bGwsXG4gICAgICAgICAgICB1cGRhdGU6IHsgYm94OiBudWxsLCBhcHBzOiBudWxsIH0sXG4gICAgICAgICAgICBpc0RldjogZmFsc2UsXG4gICAgICAgICAgICBwcm9ncmVzczoge30sXG4gICAgICAgICAgICBpc0N1c3RvbURvbWFpbjogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5faW5zdGFsbGVkQXBwcyA9IFtdO1xuXG4gICAgICAgIHRoaXMuc2V0VG9rZW4obG9jYWxTdG9yYWdlLnRva2VuKTtcbiAgICB9XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnNldFJlYWR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fcmVhZHkpIHJldHVybjtcblxuICAgICAgICB0aGlzLl9yZWFkeSA9IHRydWU7XG4gICAgICAgIHRoaXMuX3JlYWR5TGlzdGVuZXIuZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLm9uUmVhZHkgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlYWR5KSBjYWxsYmFjaygpO1xuICAgICAgICB0aGlzLl9yZWFkeUxpc3RlbmVyLnB1c2goY2FsbGJhY2spO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLm9uQ29uZmlnID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuX2NvbmZpZ0xpc3RlbmVyLnB1c2goY2FsbGJhY2spO1xuICAgICAgICBjYWxsYmFjayh0aGlzLl9jb25maWcpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnNldFVzZXJJbmZvID0gZnVuY3Rpb24gKHVzZXJJbmZvKSB7XG4gICAgICAgIC8vIEluIG9yZGVyIHRvIGtlZXAgdGhlIGFuZ3VsYXIgYmluZGluZ3MgYWxpdmUsIHNldCBlYWNoIHByb3BlcnR5IGluZGl2aWR1YWxseVxuICAgICAgICB0aGlzLl91c2VySW5mby51c2VybmFtZSA9IHVzZXJJbmZvLnVzZXJuYW1lO1xuICAgICAgICB0aGlzLl91c2VySW5mby5lbWFpbCA9IHVzZXJJbmZvLmVtYWlsO1xuICAgICAgICB0aGlzLl91c2VySW5mby5hZG1pbiA9ICEhdXNlckluZm8uYWRtaW47XG4gICAgICAgIHRoaXMuX3VzZXJJbmZvLmdyYXZhdGFyID0gJ2h0dHBzOi8vd3d3LmdyYXZhdGFyLmNvbS9hdmF0YXIvJyArIG1kNS5jcmVhdGVIYXNoKHVzZXJJbmZvLmVtYWlsLnRvTG93ZXJDYXNlKCkpICsgJy5qcGc/cz0yNCZkPW1tJztcbiAgICAgICAgdGhpcy5fdXNlckluZm8uZ3JhdmF0YXJIdWdlID0gJ2h0dHBzOi8vd3d3LmdyYXZhdGFyLmNvbS9hdmF0YXIvJyArIG1kNS5jcmVhdGVIYXNoKHVzZXJJbmZvLmVtYWlsLnRvTG93ZXJDYXNlKCkpICsgJy5qcGc/cz0xMjgmZD1tbSc7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuc2V0Q29uZmlnID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAvLyBJbiBvcmRlciB0byBrZWVwIHRoZSBhbmd1bGFyIGJpbmRpbmdzIGFsaXZlLCBzZXQgZWFjaCBwcm9wZXJ0eSBpbmRpdmlkdWFsbHkgKFRPRE86IGp1c3QgdXNlIGFuZ3VsYXIuY29weSA/KVxuICAgICAgICB0aGlzLl9jb25maWcuYXBpU2VydmVyT3JpZ2luID0gY29uZmlnLmFwaVNlcnZlck9yaWdpbjtcbiAgICAgICAgdGhpcy5fY29uZmlnLndlYlNlcnZlck9yaWdpbiA9IGNvbmZpZy53ZWJTZXJ2ZXJPcmlnaW47XG4gICAgICAgIHRoaXMuX2NvbmZpZy52ZXJzaW9uID0gY29uZmlnLnZlcnNpb247XG4gICAgICAgIHRoaXMuX2NvbmZpZy5mcWRuID0gY29uZmlnLmZxZG47XG4gICAgICAgIHRoaXMuX2NvbmZpZy5pcCA9IGNvbmZpZy5pcDtcbiAgICAgICAgdGhpcy5fY29uZmlnLnJldmlzaW9uID0gY29uZmlnLnJldmlzaW9uO1xuICAgICAgICB0aGlzLl9jb25maWcudXBkYXRlID0gY29uZmlnLnVwZGF0ZTtcbiAgICAgICAgdGhpcy5fY29uZmlnLmlzRGV2ID0gY29uZmlnLmlzRGV2O1xuICAgICAgICB0aGlzLl9jb25maWcucHJvZ3Jlc3MgPSBjb25maWcucHJvZ3Jlc3M7XG4gICAgICAgIHRoaXMuX2NvbmZpZy5pc0N1c3RvbURvbWFpbiA9IGNvbmZpZy5pc0N1c3RvbURvbWFpbjtcblxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgdGhpcy5fY29uZmlnTGlzdGVuZXIuZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRoYXQuX2NvbmZpZyk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmdldEluc3RhbGxlZEFwcHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnN0YWxsZWRBcHBzO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmdldFVzZXJJbmZvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdXNlckluZm87XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ2V0Q29uZmlnID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlnO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnNldFRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyB0b2tlbjtcbiAgICAgICAgaWYgKCF0b2tlbikgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3Rva2VuJyk7XG4gICAgICAgIGVsc2UgbG9jYWxTdG9yYWdlLnRva2VuID0gdG9rZW47XG4gICAgICAgIHRoaXMuX3Rva2VuID0gdG9rZW47XG4gICAgfTtcblxuICAgIC8qXG4gICAgICogUmVzdCBBUEkgd3JhcHBlcnNcbiAgICAgKi9cbiAgICBDbGllbnQucHJvdG90eXBlLmNvbmZpZyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvY2xvdWRyb24vY29uZmlnJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnVzZXJJbmZvID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLmdldCgnL2FwaS92MS9wcm9maWxlJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmluc3RhbGxBcHAgPSBmdW5jdGlvbiAoaWQsIG1hbmlmZXN0LCBwYXNzd29yZCwgdGl0bGUsIGNvbmZpZywgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICB2YXIgZGF0YSA9IHsgYXBwU3RvcmVJZDogaWQsIG1hbmlmZXN0OiBtYW5pZmVzdCwgcGFzc3dvcmQ6IHBhc3N3b3JkLCBsb2NhdGlvbjogY29uZmlnLmxvY2F0aW9uLCBwb3J0QmluZGluZ3M6IGNvbmZpZy5wb3J0QmluZGluZ3MsIGFjY2Vzc1Jlc3RyaWN0aW9uOiBjb25maWcuYWNjZXNzUmVzdHJpY3Rpb24gfTtcbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9hcHBzL2luc3RhbGwnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMiB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG5cbiAgICAgICAgICAgIC8vIHB1dCBuZXcgYXBwIHdpdGggYW1lbmRlZCB0aXRsZSBpbiBjYWNoZVxuICAgICAgICAgICAgZGF0YS5tYW5pZmVzdCA9IHsgdGl0bGU6IHRpdGxlIH07XG4gICAgICAgICAgICB0aGF0Ll9pbnN0YWxsZWRBcHBzLnB1c2goZGF0YSk7XG5cbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEuaWQpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUudW5pbnN0YWxsQXBwID0gZnVuY3Rpb24gKGFwcElkLCBwYXNzd29yZCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7IHBhc3N3b3JkOiBwYXNzd29yZCB9O1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL2FwcHMvJyArIGFwcElkICsgJy91bmluc3RhbGwnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMikgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuY29uZmlndXJlQXBwID0gZnVuY3Rpb24gKGlkLCBwYXNzd29yZCwgY29uZmlnLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgZGF0YSA9IHsgYXBwSWQ6IGlkLCBwYXNzd29yZDogcGFzc3dvcmQsIGxvY2F0aW9uOiBjb25maWcubG9jYXRpb24sIHBvcnRCaW5kaW5nczogY29uZmlnLnBvcnRCaW5kaW5ncywgYWNjZXNzUmVzdHJpY3Rpb246IGNvbmZpZy5hY2Nlc3NSZXN0cmljdGlvbiB9O1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL2FwcHMvJyArIGlkICsgJy9jb25maWd1cmUnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMikgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUudXBkYXRlQXBwID0gZnVuY3Rpb24gKGlkLCBtYW5pZmVzdCwgcGFzc3dvcmQsIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvYXBwcy8nICsgaWQgKyAnL3VwZGF0ZScsIHsgbWFuaWZlc3Q6IG1hbmlmZXN0LCBwYXNzd29yZDogcGFzc3dvcmQgfSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDIpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnN0YXJ0QXBwID0gZnVuY3Rpb24gKGlkLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgZGF0YSA9IHsgfTtcbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9hcHBzLycgKyBpZCArICcvc3RhcnQnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMikgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuc3RvcEFwcCA9IGZ1bmN0aW9uIChpZCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7IH07XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvYXBwcy8nICsgaWQgKyAnL3N0b3AnLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMikgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUudmVyc2lvbiA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvY2xvdWRyb24vc3RhdHVzJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmlzU2VydmVyRmlyc3RUaW1lID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLmdldCgnL2FwaS92MS9jbG91ZHJvbi9zdGF0dXMnKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAwIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsICFkYXRhLmFjdGl2YXRlZCk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5nZXROYWtlZERvbWFpbiA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvc2V0dGluZ3MvbmFrZWRfZG9tYWluJylcbiAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAwIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEuYXBwaWQpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuc2V0TmFrZWREb21haW4gPSBmdW5jdGlvbiAoYXBwaWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvc2V0dGluZ3MvbmFrZWRfZG9tYWluJywgeyBhcHBpZDogYXBwaWQgfSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDQpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmdldEFwcHMgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3YxL2FwcHMnKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhLmFwcHMpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ2V0QXBwID0gZnVuY3Rpb24gKGFwcElkLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgYXBwRm91bmQgPSBudWxsO1xuICAgICAgICB0aGlzLl9pbnN0YWxsZWRBcHBzLnNvbWUoZnVuY3Rpb24gKGFwcCkge1xuICAgICAgICAgICAgaWYgKGFwcC5pZCA9PT0gYXBwSWQpIHtcbiAgICAgICAgICAgICAgICBhcHBGb3VuZCA9IGFwcDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoYXBwRm91bmQpIHJldHVybiBjYWxsYmFjayhudWxsLCBhcHBGb3VuZCk7XG4gICAgICAgIGVsc2UgcmV0dXJuIGNhbGxiYWNrKG5ldyBFcnJvcignQXBwIG5vdCBmb3VuZCcpKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5nZXRBcHBMb2dTdHJlYW0gPSBmdW5jdGlvbiAoYXBwSWQpIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IG5ldyBFdmVudFNvdXJjZSgnL2FwaS92MS9hcHBzLycgKyBhcHBJZCArICcvbG9nc3RyZWFtJyk7XG4gICAgICAgIHJldHVybiBzb3VyY2U7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ2V0QXBwTG9nVXJsID0gZnVuY3Rpb24gKGFwcElkKSB7XG4gICAgICAgIHJldHVybiAnL2FwaS92MS9hcHBzLycgKyBhcHBJZCArICcvbG9ncz9hY2Nlc3NfdG9rZW49JyArIHRoaXMuX3Rva2VuO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnNldEFkbWluID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBhZG1pbiwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHBheWxvYWQgPSB7XG4gICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICBhZG1pbjogYWRtaW5cbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL3VzZXJzLycgKyB1c2VybmFtZSArICcvYWRtaW4nLCBwYXlsb2FkKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwNCkgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuY3JlYXRlQWRtaW4gPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkLCBlbWFpbCwgc2V0dXBUb2tlbiwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHBheWxvYWQgPSB7XG4gICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQsXG4gICAgICAgICAgICBlbWFpbDogZW1haWxcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9jbG91ZHJvbi9hY3RpdmF0ZT9zZXR1cFRva2VuPScgKyBzZXR1cFRva2VuLCBwYXlsb2FkKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAxIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcblxuICAgICAgICAgICAgdGhhdC5zZXRUb2tlbihkYXRhLnRva2VuKTtcbiAgICAgICAgICAgIHRoYXQuc2V0VXNlckluZm8oeyB1c2VybmFtZTogdXNlcm5hbWUsIGVtYWlsOiBlbWFpbCwgYWRtaW46IHRydWUgfSk7XG5cbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEuYWN0aXZhdGVkKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmxpc3RVc2VycyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvdXNlcnMnKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAwIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ2V0T0F1dGhDbGllbnRzID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLmdldCgnL2FwaS92MS9vYXV0aC9jbGllbnRzJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMCB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhLmNsaWVudHMpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZGVsVG9rZW5zQnlDbGllbnRJZCA9IGZ1bmN0aW9uIChpZCwgY2FsbGJhY2spIHtcbiAgICAgICAgJGh0dHAuZGVsZXRlKCcvYXBpL3YxL29hdXRoL2NsaWVudHMvJyArIGlkICsgJy90b2tlbnMnKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjA0KSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAocGFzc3dvcmQsIGNhbGxiYWNrKSB7XG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvY2xvdWRyb24vdXBkYXRlJywgeyBwYXNzd29yZDogcGFzc3dvcmQgfSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMiB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLnJlYm9vdCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvY2xvdWRyb24vcmVib290Jykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMiB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmJhY2t1cCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3YxL2Nsb3Vkcm9uL2JhY2t1cHMnKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAyIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuc2V0Q2VydGlmaWNhdGUgPSBmdW5jdGlvbiAoY2VydGlmaWNhdGVGaWxlLCBrZXlGaWxlLCBjYWxsYmFjaykge1xuICAgICAgICBjb25zb2xlLmxvZygnd2lsbCBzZXQgY2VydGlmaWNhdGUnKTtcblxuICAgICAgICB2YXIgZmQgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgZmQuYXBwZW5kKCdjZXJ0aWZpY2F0ZScsIGNlcnRpZmljYXRlRmlsZSk7XG4gICAgICAgIGZkLmFwcGVuZCgna2V5Jywga2V5RmlsZSk7XG5cbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9jbG91ZHJvbi9jZXJ0aWZpY2F0ZScsIGZkLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiB1bmRlZmluZWQgfSxcbiAgICAgICAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IGFuZ3VsYXIuaWRlbnRpdHlcbiAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgIT09IDIwMikgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuZ3JhcGhzID0gZnVuY3Rpb24gKHRhcmdldHMsIGZyb20sIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRhcmdldHMsXG4gICAgICAgICAgICAgICAgZm9ybWF0OiAnanNvbicsXG4gICAgICAgICAgICAgICAgZnJvbTogZnJvbVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwLmdldCgnL2FwaS92MS9jbG91ZHJvbi9ncmFwaHMnLCBjb25maWcpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjAwIHx8IHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JykgcmV0dXJuIGNhbGxiYWNrKG5ldyBDbGllbnRFcnJvcihzdGF0dXMsIGRhdGEpKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgICAgICB9KS5lcnJvcihkZWZhdWx0RXJyb3JIYW5kbGVyKGNhbGxiYWNrKSk7XG4gICAgfTtcblxuICAgIENsaWVudC5wcm90b3R5cGUuY3JlYXRlVXNlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgZW1haWwsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICAgICAgZW1haWw6IGVtYWlsXG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS91c2VycycsIGRhdGEpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDEgfHwgdHlwZW9mIGRhdGEgIT09ICdvYmplY3QnKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5yZW1vdmVVc2VyID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cCh7IG1ldGhvZDogJ0RFTEVURScsIHVybDogJy9hcGkvdjEvdXNlcnMvJyArIHVzZXJuYW1lLCBkYXRhOiBkYXRhLCBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfX0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDQpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmNoYW5nZVBhc3N3b3JkID0gZnVuY3Rpb24gKGN1cnJlbnRQYXNzd29yZCwgbmV3UGFzc3dvcmQsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgcGFzc3dvcmQ6IGN1cnJlbnRQYXNzd29yZCxcbiAgICAgICAgICAgIG5ld1Bhc3N3b3JkOiBuZXdQYXNzd29yZFxuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9hcGkvdjEvdXNlcnMvJyArIHRoaXMuX3VzZXJJbmZvLnVzZXJuYW1lICsgJy9wYXNzd29yZCcsIGRhdGEpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDQpIHJldHVybiBjYWxsYmFjayhuZXcgQ2xpZW50RXJyb3Ioc3RhdHVzLCBkYXRhKSk7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgICAgICAgfSkuZXJyb3IoZGVmYXVsdEVycm9ySGFuZGxlcihjYWxsYmFjaykpO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmNoYW5nZUVtYWlsID0gZnVuY3Rpb24gKGVtYWlsLCBwYXNzd29yZCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQsXG4gICAgICAgICAgICBlbWFpbDogZW1haWxcbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cC5wdXQoJy9hcGkvdjEvdXNlcnMvJyArIHRoaXMuX3VzZXJJbmZvLnVzZXJuYW1lLCBkYXRhKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPT0gMjA0KSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YSk7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5yZWZyZXNoQ29uZmlnID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICBjYWxsYmFjayA9IHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJyA/IGNhbGxiYWNrIDogZnVuY3Rpb24gKCkge307XG5cbiAgICAgICAgdGhpcy5jb25maWcoZnVuY3Rpb24gKGVycm9yLCByZXN1bHQpIHtcbiAgICAgICAgICAgIGlmIChlcnJvcikgcmV0dXJuIGNhbGxiYWNrKGVycm9yKTtcblxuICAgICAgICAgICAgdGhhdC5zZXRDb25maWcocmVzdWx0KTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgQ2xpZW50LnByb3RvdHlwZS5yZWZyZXNoSW5zdGFsbGVkQXBwcyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgY2FsbGJhY2sgPSB0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicgPyBjYWxsYmFjayA6IGZ1bmN0aW9uICgpIHt9O1xuXG4gICAgICAgIHRoaXMuZ2V0QXBwcyhmdW5jdGlvbiAoZXJyb3IsIGFwcHMpIHtcbiAgICAgICAgICAgIGlmIChlcnJvcikgcmV0dXJuIGNhbGxiYWNrKGVycm9yKTtcblxuICAgICAgICAgICAgLy8gaW5zZXJ0IG9yIHVwZGF0ZSBuZXcgYXBwc1xuICAgICAgICAgICAgYXBwcy5mb3JFYWNoKGZ1bmN0aW9uIChhcHApIHtcbiAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhhdC5faW5zdGFsbGVkQXBwcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhhdC5faW5zdGFsbGVkQXBwc1tpXS5pZCA9PT0gYXBwLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChmb3VuZCAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5jb3B5KGFwcCwgdGhhdC5faW5zdGFsbGVkQXBwc1tmb3VuZF0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX2luc3RhbGxlZEFwcHMucHVzaChhcHApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBmaWx0ZXIgb3V0IG9sZCBlbnRyaWVzLCBnb2luZyBiYWNrd2FyZHMgdG8gYWxsb3cgc3BsaWNpbmdcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IHRoYXQuX2luc3RhbGxlZEFwcHMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWFwcHMuc29tZShmdW5jdGlvbiAoZWxlbSkgeyByZXR1cm4gKGVsZW0uaWQgPT09IHRoYXQuX2luc3RhbGxlZEFwcHNbaV0uaWQpOyB9KSkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0Ll9pbnN0YWxsZWRBcHBzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zZXRUb2tlbihudWxsKTtcbiAgICAgICAgdGhpcy5fdXNlckluZm8gPSB7fTtcblxuICAgICAgICAvLyBsb2dvdXQgZnJvbSBPQXV0aCBzZXNzaW9uXG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9hcGkvdjEvc2Vzc2lvbi9sb2dvdXQnO1xuICAgIH07XG5cbiAgICBDbGllbnQucHJvdG90eXBlLmV4Y2hhbmdlQ29kZUZvclRva2VuID0gZnVuY3Rpb24gKGF1dGhDb2RlLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIGdyYW50X3R5cGU6ICdhdXRob3JpemF0aW9uX2NvZGUnLFxuICAgICAgICAgICAgY29kZTogYXV0aENvZGUsXG4gICAgICAgICAgICByZWRpcmVjdF91cmk6IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sXG4gICAgICAgICAgICBjbGllbnRfaWQ6IHRoaXMuX2NsaWVudElkLFxuICAgICAgICAgICAgY2xpZW50X3NlY3JldDogdGhpcy5fY2xpZW50U2VjcmV0XG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAucG9zdCgnL2FwaS92MS9vYXV0aC90b2tlbj9yZXNwb25zZV90eXBlPXRva2VuJmNsaWVudF9pZD0nICsgdGhpcy5fY2xpZW50SWQsIGRhdGEpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzICE9PSAyMDAgfHwgdHlwZW9mIGRhdGEgIT09ICdvYmplY3QnKSByZXR1cm4gY2FsbGJhY2sobmV3IENsaWVudEVycm9yKHN0YXR1cywgZGF0YSkpO1xuXG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkYXRhLmFjY2Vzc190b2tlbik7XG4gICAgICAgIH0pLmVycm9yKGRlZmF1bHRFcnJvckhhbmRsZXIoY2FsbGJhY2spKTtcbiAgICB9O1xuXG4gICAgY2xpZW50ID0gbmV3IENsaWVudCgpO1xuICAgIHJldHVybiBjbGllbnQ7XG59XSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=