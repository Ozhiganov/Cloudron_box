<!-- Modal add user -->
<div class="modal fade" id="userAddModal" tabindex="-1" role="dialog" aria-labelledby="updateModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="userAddModalLabel">Add User</h4>
            </div>
            <div class="modal-body">
                <form name="useradd_form" class="form-signin" role="form" novalidate ng-submit="doAdd()" autocomplete="off">
                    <fieldset>
                        <input type="password" style="display: none;">
                        <div class="form-group" ng-class="{ 'has-error': (useradd_form.username.$dirty && useradd_form.username.$invalid) || (!useradd_form.username.$dirty && useradd.error.username) }">
                            <label class="control-label" for="inputUserAddUsername">Username</label>
                            <div class="control-label" ng-show="(!useradd_form.username.$dirty && useradd.error.username) || (useradd_form.username.$dirty && useradd_form.username.$invalid) || (!useradd_form.username.$dirty && useradd.error.username)">
                                <small ng-show="useradd_form.username.$error.required">A username is required</small>
                                <small ng-show="useradd_form.username.$error.minlength">The username is too short</small>
                                <small ng-show="useradd_form.username.$error.maxlength">The username is too long</small>
                                <small ng-show="!useradd_form.username.$dirty && useradd.error.username">{{ useradd.error.username }}</small>
                            </div>
                            <input type="text" class="form-control" ng-model="useradd.username" id="inputUserAddUsername" name="username" ng-maxlength="512" ng-minlength="3" required autofocus>
                        </div>
                        <div class="form-group" ng-class="{ 'has-error': (useradd_form.email.$dirty && useradd_form.email.$invalid) || (!useradd_form.email.$dirty && useradd.error.email) }">
                            <label class="control-label" for="inputUserAddEmail">Email</label>
                            <div class="control-label" ng-show="(!useradd_form.email.$dirty && useradd.error.email) || (useradd_form.email.$dirty && useradd_form.email.$invalid) || (!useradd_form.email.$dirty && useradd.error.email)">
                                <small ng-show="useradd_form.email.$error.required">An email is required</small>
                                <small ng-show="useradd_form.email.$error.email">This is not a valid email</small>
                                <small ng-show="!useradd_form.email.$dirty && useradd.error.email">{{ useradd.error.email }}</small>
                            </div>
                            <input type="email" class="form-control" ng-model="useradd.email" id="inputUserAddEmail" name="email" required>
                        </div>

                        <div class="form-group" ng-class="{ 'has-error': (useradd_form.displayName.$dirty && useradd_form.displayName.$invalid) || (!useradd_form.displayName.$dirty && useradd.error.displayName) }">
                            <label class="control-label" for="inputUserAddDisplayName">Full Name</label>
                            <div class="control-label" ng-show="(!useradd_form.displayName.$dirty && useradd.error.displayName) || (useradd_form.displayname.$dirty && useradd_form.displayName.$invalid) || (!useradd_form.displayName.$dirty && useradd.error.displayName)">
                                <small ng-show="useradd_form.displayName.$error.required">A Name is required</small>
                                <small ng-show="useradd_form.displayName.$error.displayName">This is not a valid Name</small>
                                <small ng-show="!useradd_form.displayName.$dirty && useradd.error.displayName">{{ useradd.error.displayName }}</small>
                            </div>
                            <input type="text" class="form-control" ng-model="useradd.displayName" id="inputUserAddDisplayName" name="displayName">
                        </div>

                        <div class="checkbox">
                            <label>
                                <input type="checkbox" ng-model="useradd.sendInvite" id="inputUserAddSendInvite"> Send invite
                            </label>
                        </div>
                        <input class="ng-hide" type="submit" ng-disabled="useradd_form.$invalid || useradd.alreadyTaken === username"/>
                    </fieldset>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" ng-click="doAdd()" ng-disabled="useradd_form.$invalid || useradd.busy"><i class="fa fa-spinner fa-pulse" ng-show="useradd.busy"></i> Add User</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal remove user -->
<div class="modal fade" id="userRemoveModal" tabindex="-1" role="dialog" aria-labelledby="userRemoveModalLabel" aria-hidden="true" style="text-align: left;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="userRemoveModalLabel">Delete user {{ userremove.userInfo.username }}</h4>
            </div>
            <div class="modal-body">
                <form name="userremove_form" role="form" ng-submit="doUserRemove()" name="userDeleteConfirm" autocomplete="off">
                    <fieldset>
                        <input type="password" style="display: none;">
                        <div class="form-group" ng-class="{ 'has-error': (userremove_form.username.$dirty && userremove_form.username.$invalid) || (!userremove_form.username.$dirty && userremove.error.username) }">
                            <label class="control-label" for="inputUserRemoveUsername">Just to be sure you really want to delete this user, please type the user's name</label>
                            <div class="control-label" ng-show="(!userremove_form.username.$dirty && userremove.error.username) || (userremove_form.username.$dirty && userremove_form.username.$invalid)">
                                <small ng-show="userremove_form.username.$error.required">A username is required</small>
                                <small ng-show="userremove_form.error.username">The username does not match</small>
                            </div>
                            <input type="text" class="form-control" ng-model="userremove.username" id="inputUserRemoveUsername" name="userDeleteConfirm" placeholder="Username" required autofocus>
                        </div>
                        <div class="form-group" ng-class="{ 'has-error': (userremove_form.password.$dirty && userremove_form.password.$invalid) || (!userremove_form.password.$dirty && userremove.error.password)}">
                            <label class="control-label" for="inputUserRemovePassword">Give your password to verify that you are performing that action</label>
                            <div class="control-label" ng-show="(!userremove_form.password.$dirty && userremove.error.password) || (userremove_form.password.$dirty && userremove_form.password.$invalid)">
                                <small ng-show="userremove_form.password.$error.required && !userremove.error.password">A password is required</small>
                                <small ng-show="!useradd_form.email.$dirty && userremove.error.password">{{ userremove.error.password }}</small>
                            </div>
                            <input type="password" class="form-control" ng-model="userremove.password" id="inputUserRemovePassword" name="password" placeholder="Password" required>
                        </div>
                        <input class="hide" type="submit"/>
                    </fieldset>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-danger" ng-click="doUserRemove()" ng-disabled="userremove_form.$invalid || userremove.busy"><i class="fa fa-spinner fa-pulse" ng-show="userremove.busy"></i> Delete</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal edit user -->
<div class="modal fade" id="userEditModal" tabindex="-1" role="dialog" aria-labelledby="userEditModalLabel" aria-hidden="true" style="text-align: left;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="userEditModalLabel">Edit user {{ useredit.userInfo.username }}</h4>
            </div>
            <div class="modal-body">
                <form name="useredit_form" role="form" ng-submit="doUserEdit()" autocomplete="off">
                    <fieldset>
                        <input type="password" style="display: none;">
                        <div class="form-group" ng-class="{ 'has-error': (useredit_form.displayName.$dirty && useredit_form.displayName.$invalid) || (!useredit_form.displayName.$dirty && useredit.error.displayName) }">
                            <label class="control-label" for="inputUsereditDisplayName">Full Name</label>
                            <div class="control-label" ng-show="(!useredit_form.displayName.$dirty && useredit.error.displayName) || (useredit_form.displayName.$dirty && useredit_form.displayName.$invalid)">
                                <small ng-show="useredit_form.error.displayName">Invalid name</small>
                            </div>
                            <input type="text" class="form-control" ng-model="useredit.displayName" id="inputUsereditDisplayName" name="displayName" placeholder="Full Name" autofocus>
                        </div>
                        <div class="form-group" ng-class="{ 'has-error': (useredit_form.email.$dirty && useredit_form.email.$invalid) || (!useredit_form.email.$dirty && useredit.error.email) }">
                            <label class="control-label" for="inputUserEditEmail">Email</label>
                            <div class="control-label" ng-show="(!useredit_form.email.$dirty && useredit.error.email) || (useredit_form.email.$dirty && useredit_form.email.$invalid) || (!useredit_form.email.$dirty && useredit.error.email)">
                                <small ng-show="useredit_form.email.$error.required">An email is required</small>
                                <small ng-show="useredit_form.email.$error.email">This is not a valid email</small>
                                <small ng-show="!useredit_form.email.$dirty && useredit.error.email">{{ useredit.error.email }}</small>
                            </div>
                            <input type="email" class="form-control" ng-model="useredit.email" id="inputUserEditEmail" name="email" required>
                        </div>
                        <div class="form-group">
                            <label class="control-label" for="inputUserEditGroups">Groups</label>
                            <div>
                                <button class="btn btn-default" type="button" ng-repeat="group in groups" ng-click="userEditToggleGroup(group);" ng-class="{ 'btn-primary': (useredit.groupIds.indexOf(group.id) !== -1) }">{{ group.name }}</button>
                            </div>
                        </div>
                        <div class="form-group" ng-class="{ 'has-error': (useredit_form.password.$dirty && useredit_form.password.$invalid) || (!useredit_form.password.$dirty && useredit.error.password)}">
                            <label class="control-label" for="inputusereditPassword">Give your password to verify that you are performing that action</label>
                            <div class="control-label" ng-show="(!useredit_form.password.$dirty && useredit.error.password) || (useredit_form.password.$dirty && useredit_form.password.$invalid)">
                                <small ng-show="useredit_form.password.$error.required && !useredit.error.password">A password is required</small>
                                <small ng-show="!useredit_form.password.$dirty && useredit.error.password">{{ useredit.error.password }}</small>
                            </div>
                            <input type="password" class="form-control" ng-model="useredit.password" id="inputUserRemovePassword" name="password" placeholder="Password" required>
                        </div>
                        <input class="hide" type="submit" ng-disabled="useredit_form.$invalid"/>
                    </fieldset>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-success" ng-click="doUserEdit()" ng-disabled="useredit_form.$invalid || useredit.busy"><i class="fa fa-spinner fa-pulse" ng-show="useredit.busy"></i> Edit</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal add group -->
<div class="modal fade" id="groupAddModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Add Group</h4>
            </div>
            <div class="modal-body">
                <form name="groupAddForm" role="form" novalidate ng-submit="groupadd.submit()" autocomplete="off">
                    <div class="form-group" ng-class="{ 'has-error': (groupAddForm.name.$dirty && groupAddForm.name.$invalid) || (!groupAddForm.name.$dirty && groupadd.error.name) }">
                        <label class="control-label" for="groupAddName">Name</label>
                        <div class="control-label" ng-show="(!groupAddForm.name.$dirty && groupadd.error.name) || (groupAddForm.name.$dirty && groupAddForm.name.$invalid) || (!groupAddForm.name.$dirty && groupadd.error.name)">
                            <small ng-show="groupAddForm.name.$error.required">A name is required</small>
                            <small ng-show="groupAddForm.name.$error.minlength">The name is too short</small>
                            <small ng-show="groupAddForm.name.$error.maxlength">The name is too long</small>
                            <small ng-show="!groupAddForm.name.$dirty && groupadd.error.name">{{ groupadd.error.name }}</small>
                        </div>
                        <input type="text" class="form-control" ng-model="groupadd.name" id="groupAddName" name="name" ng-maxlength="200" ng-minlength="2" required autofocus>
                    </div>
                    <input class="ng-hide" type="submit" ng-disabled="groupAddForm.$invalid || groupadd.busy"/>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" ng-click="groupadd.submit()" ng-disabled="groupAddForm.$invalid || groupadd.busy"><i class="fa fa-spinner fa-pulse" ng-show="groupadd.busy"></i> Add Group</button>
            </div>
        </div>
    </div>
</div>

<div class="content">

    <br/>

    <div>
        <div class="text-left">
            <h1>Users <button class="btn btn-primary btn-outline pull-right" ng-click="showUserAdd()"><i class="fa fa-user-plus"></i> New User</button></h1>
        </div>
    </div>

    <div class="card card-large">
        <div class="grid-item-top">
            <div class="row ng-hide" ng-show="!ready">
                <div class="col-lg-12 text-center">
                    <h2><i class="fa fa-spinner fa-pulse"></i></h2>
                </div>
            </div>
            <div class="row animateMeOpacity ng-hide" ng-show="ready">
                <div class="col-lg-12">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th style="">User</th>
                                <th style="width: 1px" class="text-right">Groups</th>
                                <th style="width: 300px" class="text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="user in users">
                                <td class="text-overflow: ellipsis; white-space: nowrap;">
                                    {{ user.username }}
                                    <span class="text-muted">{{ user.email }}</span>
                                    <span ng-show="isMe(user)" class="label label-success">This is you!</span>
                                </td>
                                <td class="text-right" style="vertical-align: bottom">
                                    <span ng-show="isAdmin(user)" class="label label-default">Admin</span>
                                </td>
                                <td class="text-right" style="vertical-align: bottom">
                                    <button ng-show="!isMe(user) && userInfo.admin" class="btn btn-xs btn-danger" ng-click="showUserRemove(user)" title="Remove User"><i class="fa fa-trash-o"></i></button>
                                    <button ng-show="!isMe(user) && userInfo.admin" class="btn btn-xs btn-default" ng-click="sendInvite(user)" title="Send Invite"><i class="fa fa-paper-plane-o"></i></button>
                                    <button ng-show="userInfo.admin" class="btn btn-xs btn-default" ng-click="showUserEdit(user)" title="Edit User Profile"><i class="fa fa-pencil"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <br/>

    <div>
        <div class="text-left">
            <h1>Groups <button class="btn btn-primary btn-outline pull-right" ng-click="groupadd.show()"><i class="fa fa-plus"></i> New Group</button></h1>
        </div>
    </div>

    <div class="card card-large">
        <div class="grid-item-top">
            <div class="row ng-hide" ng-show="!ready">
                <div class="col-lg-12 text-center">
                    <h2><i class="fa fa-spinner fa-pulse"></i></h2>
                </div>
            </div>
            <div class="row animateMeOpacity ng-hide" ng-show="ready">
                <div class="col-lg-12">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th style="">Name</th>
                                <th style="width: 300px" class="text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="group in groups">
                                <td class="text-overflow: ellipsis; white-space: nowrap;">
                                    {{ group.name }}
                                </td>
                                <td class="text-right" style="vertical-align: bottom">
                                    <button ng-show="userInfo.admin" class="btn btn-xs btn-danger" ng-click="showGroupRemove(user)" title="Remove Group"><i class="fa fa-trash-o"></i></button>
                                    <button ng-show="userInfo.admin" class="btn btn-xs btn-default" ng-click="showGroupEdit(user)" title="Edit Group"><i class="fa fa-pencil"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
